# /// script
# dependencies = []
# 
# [tool.griptape-nodes]
# name = "Flux 2 - Magazine Cover"
# schema_version = "0.14.0"
# engine_version_created_with = "0.66.0"
# node_libraries_referenced = [["Griptape Nodes Library", "0.52.10"]]
# node_types_used = [["Griptape Nodes Library", "Agent"], ["Griptape Nodes Library", "AspectRatio"], ["Griptape Nodes Library", "EndFlow"], ["Griptape Nodes Library", "Flux2ImageGeneration"], ["Griptape Nodes Library", "MergeTexts"], ["Griptape Nodes Library", "Note"], ["Griptape Nodes Library", "Ruleset"], ["Griptape Nodes Library", "StartFlow"]]
# description = "Generate an image for a topical magazine cover using Black Forest Labs Flux.2 Text to Image generation, along with OpenAI gpt-4.1-mini to guide the prompt."
# is_griptape_provided = true
# is_template = true
# creation_date = 2025-12-19T15:38:19.044089Z
# last_modified_date = "2025-12-19T15:52:47.668191Z"
# workflow_shape = "{\"inputs\":{\"Start Flow\":{\"exec_out\":{\"name\":\"exec_out\",\"tooltip\":\"Connection to the next node in the execution chain\",\"type\":\"parametercontroltype\",\"input_types\":[\"parametercontroltype\"],\"output_type\":\"parametercontroltype\",\"default_value\":null,\"tooltip_as_input\":null,\"tooltip_as_property\":null,\"tooltip_as_output\":null,\"ui_options\":{\"display_name\":\"Flow Out\"},\"settable\":true,\"is_user_defined\":true,\"parent_container_name\":null,\"parent_element_name\":null},\"text\":{\"name\":\"text\",\"tooltip\":\"New parameter\",\"type\":\"str\",\"input_types\":[\"any\"],\"output_type\":\"str\",\"default_value\":\"\",\"tooltip_as_input\":null,\"tooltip_as_property\":null,\"tooltip_as_output\":null,\"ui_options\":{\"multiline\":true,\"placeholder_text\":\"The text content to display\",\"hide_label\":false,\"hide_property\":false,\"is_custom\":true,\"is_user_added\":true,\"hide\":false,\"display_name\":\"subject\"},\"settable\":true,\"is_user_defined\":true,\"parent_container_name\":\"\",\"parent_element_name\":null},\"text_1\":{\"name\":\"text_1\",\"tooltip\":\"New parameter\",\"type\":\"str\",\"input_types\":[\"any\"],\"output_type\":\"str\",\"default_value\":\"\",\"tooltip_as_input\":null,\"tooltip_as_property\":null,\"tooltip_as_output\":null,\"ui_options\":{\"multiline\":true,\"placeholder_text\":\"The text content to display\",\"hide_label\":false,\"hide_property\":false,\"is_custom\":true,\"is_user_added\":true,\"hide\":false,\"display_name\":\"decade\"},\"settable\":true,\"is_user_defined\":true,\"parent_container_name\":\"\",\"parent_element_name\":null}}},\"outputs\":{\"End Flow\":{\"exec_in\":{\"name\":\"exec_in\",\"tooltip\":\"Control path when the flow completed successfully\",\"type\":\"parametercontroltype\",\"input_types\":[\"parametercontroltype\"],\"output_type\":\"parametercontroltype\",\"default_value\":null,\"tooltip_as_input\":null,\"tooltip_as_property\":null,\"tooltip_as_output\":null,\"ui_options\":{\"display_name\":\"Succeeded\"},\"settable\":true,\"is_user_defined\":true,\"parent_container_name\":null,\"parent_element_name\":null},\"failed\":{\"name\":\"failed\",\"tooltip\":\"Control path when the flow failed\",\"type\":\"parametercontroltype\",\"input_types\":[\"parametercontroltype\"],\"output_type\":\"parametercontroltype\",\"default_value\":null,\"tooltip_as_input\":null,\"tooltip_as_property\":null,\"tooltip_as_output\":null,\"ui_options\":{\"display_name\":\"Failed\"},\"settable\":true,\"is_user_defined\":true,\"parent_container_name\":null,\"parent_element_name\":null},\"was_successful\":{\"name\":\"was_successful\",\"tooltip\":\"Indicates whether it completed without errors.\",\"type\":\"bool\",\"input_types\":[\"bool\"],\"output_type\":\"bool\",\"default_value\":false,\"tooltip_as_input\":null,\"tooltip_as_property\":null,\"tooltip_as_output\":null,\"ui_options\":{},\"settable\":false,\"is_user_defined\":true,\"parent_container_name\":null,\"parent_element_name\":null},\"result_details\":{\"name\":\"result_details\",\"tooltip\":\"Details about the operation result\",\"type\":\"str\",\"input_types\":[\"str\"],\"output_type\":\"str\",\"default_value\":null,\"tooltip_as_input\":null,\"tooltip_as_property\":null,\"tooltip_as_output\":null,\"ui_options\":{\"multiline\":true,\"placeholder_text\":\"Details about the completion or failure will be shown here.\"},\"settable\":false,\"is_user_defined\":true,\"parent_container_name\":null,\"parent_element_name\":null},\"image_url\":{\"name\":\"image_url\",\"tooltip\":\"New parameter\",\"type\":\"ImageUrlArtifact\",\"input_types\":[\"ImageUrlArtifact\"],\"output_type\":\"ImageUrlArtifact\",\"default_value\":\"\",\"tooltip_as_input\":null,\"tooltip_as_property\":null,\"tooltip_as_output\":null,\"ui_options\":{\"is_full_width\":true,\"pulse_on_run\":true,\"is_custom\":true,\"is_user_added\":true},\"settable\":true,\"is_user_defined\":true,\"parent_container_name\":\"\",\"parent_element_name\":null}}}}"
# image = "https://raw.githubusercontent.com/griptape-ai/griptape-nodes/refs/heads/main/libraries/griptape_nodes_library/workflows/templates/thumbnail_flux_2_-_magazine_cover.webp"
# 
# ///

import argparse
import asyncio
import json
import pickle
from griptape.artifacts.image_url_artifact import ImageUrlArtifact
from griptape.rules.ruleset import Ruleset
from griptape_nodes.bootstrap.workflow_executors.local_workflow_executor import LocalWorkflowExecutor
from griptape_nodes.bootstrap.workflow_executors.workflow_executor import WorkflowExecutor
from griptape_nodes.drivers.storage.storage_backend import StorageBackend
from griptape_nodes.node_library.library_registry import IconVariant, NodeDeprecationMetadata, NodeMetadata
from griptape_nodes.retained_mode.events.connection_events import CreateConnectionRequest
from griptape_nodes.retained_mode.events.flow_events import CreateFlowRequest, GetTopLevelFlowRequest, GetTopLevelFlowResultSuccess
from griptape_nodes.retained_mode.events.library_events import LoadLibrariesRequest
from griptape_nodes.retained_mode.events.node_events import CreateNodeRequest
from griptape_nodes.retained_mode.events.parameter_events import AddParameterToNodeRequest, AlterParameterDetailsRequest, SetParameterValueRequest
from griptape_nodes.retained_mode.griptape_nodes import GriptapeNodes

GriptapeNodes.handle_request(LoadLibrariesRequest())

context_manager = GriptapeNodes.ContextManager()

if not context_manager.has_current_workflow():
    context_manager.push_workflow(workflow_name='Flux 2 - Magazine Cover')

"""
1. We've collated all of the unique parameter values into a dictionary so that we do not have to duplicate them.
   This minimizes the size of the code, especially for large objects like serialized image files.
2. We're using a prefix so that it's clear which Flow these values are associated with.
3. The values are serialized using pickle, which is a binary format. This makes them harder to read, but makes
   them consistently save and load. It allows us to serialize complex objects like custom classes, which otherwise
   would be difficult to serialize.
"""
top_level_unique_values_dict = {'fa50565b-924f-4b74-9edc-3ba796341fb5': pickle.loads(b'\x80\x04\x95)\x00\x00\x00\x00\x00\x00\x00\x8c%a plastic skateboarding action figure\x94.'), '17187494-76c6-4fbe-ad16-73ffe3a3c3a0': pickle.loads(b'\x80\x04\x95\x10\x00\x00\x00\x00\x00\x00\x00\x8c\x0c1990s grunge\x94.'), '8970c9b2-8220-4ce8-beec-eb13c8f7d337': pickle.loads(b'\x80\x04\x95\x1a\x00\x00\x00\x00\x00\x00\x00\x8c\x16Flux 2 Prompting Guide\x94.'), '7a06b327-8d79-45df-b853-46b9bfb36cc5': pickle.loads(b'\x80\x04\x95\x18\r\x00\x00\x00\x00\x00\x00X\x11\r\x00\x00**Rules for Crafting Prompts:**\n\n1. **Focus on Positive Descriptions**  \n   - Avoid negative prompts. Describe what you want clearly.  \n   - Example: Use "sharp focus throughout" instead of "no blur."\n\n2. **Prompt Structure**  \n   - Follow: **Subject + Action + Style + Context**  \n   - Example:  \n     - *"Black cat hiding behind a watermelon slice, professional studio shot, bright red and turquoise background with summer mystery vibe."*\n\n3. **Prioritize Word Order**  \n   - Place the most important details first: **Main subject \xe2\x86\x92 Key action \xe2\x86\x92 Style \xe2\x86\x92 Context \xe2\x86\x92 Secondary details.**\n\n4. **Prompt Length**  \n   - **Short (10\xe2\x80\x9330 words)**: Quick concepts.  \n   - **Medium (30\xe2\x80\x9380 words)**: Ideal for most prompts.  \n   - **Long (80+ words)**: For detailed scenes.\n\n5. **Photorealistic Styles**  \n   - Reference eras, cameras, or techniques for specific looks.  \n   - Example: *"Shot on Kodak Portra 400, natural grain, organic colors."*\n\n6. **Camera and Lens Details**  \n   - Specify models, lenses, and settings for realism.  \n   - Example: *"Canon 5D Mark IV, 24-70mm at 35mm, golden hour, shallow depth of field."*\n\n7. **Typography and Design**  \n   - Use quotation marks for text elements and specify placement, style, and color.  \n   - Example: *"The text \'OPEN\' appears in red neon letters above the door."*\n\n8. **Precise Colors with HEX Codes**  \n   - Use hex codes for exact color matching.  \n   - Example: *"The vase is #02eb3c, with a background of #1a1a2e."*\n\n9. **Multi-Language Support**  \n   - Prompt in your native language for cultural authenticity.  \n   - Example: *"Un march\xc3\xa9 alimentaire dans la campagne normande, lever de soleil, temps un peu brumeux."*\n\n10. **Comic Strips and Sequential Art**  \n    - Maintain consistent character descriptions across panels.  \n    - Example:  \n      - Panel 1: *"Worried scientist typing on glowing holographic keyboard."*  \n      - Panel 2: *"Diffusion Man glows with swirling gradients of purple and blue energy."*\n\n11. **JSON for Complex Scenes**  \n    - Use structured JSON for precise control.  \n    - Example:  \n      ```json\n      {\n        "scene": "Professional studio product photography setup",\n        "subjects": [\n          {\n            "description": "Minimalist ceramic coffee mug with steam rising",\n            "position": "Center foreground",\n            "color_palette": ["matte black ceramic"]\n          }\n        ],\n        "style": "Ultra-realistic product photography",\n        "lighting": "Softbox setup creating diffused highlights",\n        "camera": {\n          "angle": "high angle",\n          "lens-mm": 85,\n          "f-number": "f/5.6"\n        }\n      }\n      ```\n\n12. **Aspect Ratios and Resolution**  \n    - Choose aspect ratios based on use case:  \n      - **1:1**: Social media.  \n      - **16:9**: Cinematic shots.  \n      - **9:16**: Mobile content.  \n      - **4:3**: Magazine layouts.  \n      - **21:9**: Panoramas.  \n    - Recommended resolution: Up to 2MP.\n\n13. **Best Practices Summary**  \n    - **Describe What You Want**: Focus on desired elements.  \n    - **Be Specific with Colors**: Use hex codes for precision.  \n    - **Reference Camera and Style**: Specify models and techniques.  \n    - **Use Native Languages**: Prompt in culturally relevant languages.  \n    - **Structure for Control**: Use JSON for detailed automation.\n\x94.'), 'fe887c4a-b7d9-487e-9745-10db25cbb0ae': pickle.loads(b'\x80\x04\x95G\x10\x00\x00\x00\x00\x00\x00\x8c\x16griptape.rules.ruleset\x94\x8c\x07Ruleset\x94\x93\x94)\x81\x94}\x94(\x8c\x04type\x94\x8c\x07Ruleset\x94\x8c\x0bmodule_name\x94\x8c\x16griptape.rules.ruleset\x94\x8c\x02id\x94\x8c aa0c1a894a1e45a582f4d821f9f45595\x94\x8c\x04name\x94\x8c\x16Flux 2 Prompting Guide\x94\x8c\x0eruleset_driver\x94\x8c-griptape.drivers.ruleset.local_ruleset_driver\x94\x8c\x12LocalRulesetDriver\x94\x93\x94)\x81\x94}\x94(h\x05\x8c\x12LocalRulesetDriver\x94h\x07\x8c-griptape.drivers.ruleset.local_ruleset_driver\x94\x8c\x0fraise_not_found\x94\x88\x8c\x0bpersist_dir\x94Nub\x8c\x04meta\x94}\x94\x8c\x05rules\x94]\x94(\x8c\x13griptape.rules.rule\x94\x8c\x04Rule\x94\x93\x94)\x81\x94}\x94(h\x05\x8c\x04Rule\x94h\x07\x8c\x13griptape.rules.rule\x94h\x17}\x94\x8c\x05value\x94\x8c\x1f**Rules for Crafting Prompts:**\x94ubh\x1d)\x81\x94}\x94(h\x05h h\x07h!h\x17}\x94h#\x8c\xa71. **Focus on Positive Descriptions**  \n   - Avoid negative prompts. Describe what you want clearly.  \n   - Example: Use "sharp focus throughout" instead of "no blur."\x94ubh\x1d)\x81\x94}\x94(h\x05h h\x07h!h\x17}\x94h#\x8c\xee2. **Prompt Structure**  \n   - Follow: **Subject + Action + Style + Context**  \n   - Example:  \n     - *"Black cat hiding behind a watermelon slice, professional studio shot, bright red and turquoise background with summer mystery vibe."*\x94ubh\x1d)\x81\x94}\x94(h\x05h h\x07h!h\x17}\x94h#\x8c\x983. **Prioritize Word Order**  \n   - Place the most important details first: **Main subject \xe2\x86\x92 Key action \xe2\x86\x92 Style \xe2\x86\x92 Context \xe2\x86\x92 Secondary details.**\x94ubh\x1d)\x81\x94}\x94(h\x05h h\x07h!h\x17}\x94h#\x8c\xb34. **Prompt Length**  \n   - **Short (10\xe2\x80\x9330 words)**: Quick concepts.  \n   - **Medium (30\xe2\x80\x9380 words)**: Ideal for most prompts.  \n   - **Long (80+ words)**: For detailed scenes.\x94ubh\x1d)\x81\x94}\x94(h\x05h h\x07h!h\x17}\x94h#\x8c\xab5. **Photorealistic Styles**  \n   - Reference eras, cameras, or techniques for specific looks.  \n   - Example: *"Shot on Kodak Portra 400, natural grain, organic colors."*\x94ubh\x1d)\x81\x94}\x94(h\x05h h\x07h!h\x17}\x94h#\x8c\xb36. **Camera and Lens Details**  \n   - Specify models, lenses, and settings for realism.  \n   - Example: *"Canon 5D Mark IV, 24-70mm at 35mm, golden hour, shallow depth of field."*\x94ubh\x1d)\x81\x94}\x94(h\x05h h\x07h!h\x17}\x94h#\x8c\xc27. **Typography and Design**  \n   - Use quotation marks for text elements and specify placement, style, and color.  \n   - Example: *"The text \'OPEN\' appears in red neon letters above the door."*\x94ubh\x1d)\x81\x94}\x94(h\x05h h\x07h!h\x17}\x94h#\x8c\x9a8. **Precise Colors with HEX Codes**  \n   - Use hex codes for exact color matching.  \n   - Example: *"The vase is #02eb3c, with a background of #1a1a2e."*\x94ubh\x1d)\x81\x94}\x94(h\x05h h\x07h!h\x17}\x94h#\x8c\xcb9. **Multi-Language Support**  \n   - Prompt in your native language for cultural authenticity.  \n   - Example: *"Un march\xc3\xa9 alimentaire dans la campagne normande, lever de soleil, temps un peu brumeux."*\x94ubh\x1d)\x81\x94}\x94(h\x05h h\x07h!h\x17}\x94h#X)\x01\x00\x0010. **Comic Strips and Sequential Art**  \n    - Maintain consistent character descriptions across panels.  \n    - Example:  \n      - Panel 1: *"Worried scientist typing on glowing holographic keyboard."*  \n      - Panel 2: *"Diffusion Man glows with swirling gradients of purple and blue energy."*\x94ubh\x1d)\x81\x94}\x94(h\x05h h\x07h!h\x17}\x94h#X\xa6\x02\x00\x0011. **JSON for Complex Scenes**  \n    - Use structured JSON for precise control.  \n    - Example:  \n      ```json\n      {\n        "scene": "Professional studio product photography setup",\n        "subjects": [\n          {\n            "description": "Minimalist ceramic coffee mug with steam rising",\n            "position": "Center foreground",\n            "color_palette": ["matte black ceramic"]\n          }\n        ],\n        "style": "Ultra-realistic product photography",\n        "lighting": "Softbox setup creating diffused highlights",\n        "camera": {\n          "angle": "high angle",\n          "lens-mm": 85,\n          "f-number": "f/5.6"\n        }\n      }\n      ```\x94ubh\x1d)\x81\x94}\x94(h\x05h h\x07h!h\x17}\x94h#X-\x01\x00\x0012. **Aspect Ratios and Resolution**  \n    - Choose aspect ratios based on use case:  \n      - **1:1**: Social media.  \n      - **16:9**: Cinematic shots.  \n      - **9:16**: Mobile content.  \n      - **4:3**: Magazine layouts.  \n      - **21:9**: Panoramas.  \n    - Recommended resolution: Up to 2MP.\x94ubh\x1d)\x81\x94}\x94(h\x05h h\x07h!h\x17}\x94h#Xw\x01\x00\x0013. **Best Practices Summary**  \n    - **Describe What You Want**: Focus on desired elements.  \n    - **Be Specific with Colors**: Use hex codes for precision.  \n    - **Reference Camera and Style**: Specify models and techniques.  \n    - **Use Native Languages**: Prompt in culturally relevant languages.  \n    - **Structure for Control**: Use JSON for detailed automation.\n\x94ubeub.'), '21509fc4-866c-4a7f-a503-a1af8a677513': pickle.loads(b'\x80\x04\x95\x0c\x00\x00\x00\x00\x00\x00\x00\x8c\x08Subject:\x94.'), '35ce2ed2-a9ac-4ee1-8282-b9b7f56dca2f': pickle.loads(b'\x80\x04\x95\x0b\x00\x00\x00\x00\x00\x00\x00\x8c\x07Decade:\x94.'), '52e340f1-291b-4bb2-acc8-3a6205598ba0': pickle.loads(b'\x80\x04\x95\x06\x00\x00\x00\x00\x00\x00\x00\x8c\x02\\n\x94.'), '2b7350c7-e59d-4634-a125-d8eba82936b0': pickle.loads(b'\x80\x04\x89.'), '0b766ff0-acb8-48aa-8f03-116ae28f72e2': pickle.loads(b'\x80\x04\x95G\x00\x00\x00\x00\x00\x00\x00\x8cCSubject:\na plastic skateboarding action figure\nDecade:\n1990s grunge\x94.'), 'e1d1d1ba-adbd-4183-bfa8-2e811bea20d2': pickle.loads(b'\x80\x04\x88.'), 'b613d2a8-c4ed-462d-b6fe-b00fc4dc8b94': pickle.loads(b'\x80\x04\x95R\x00\x00\x00\x00\x00\x00\x00\x8cN[SUCCEEDED] No connection provided for success or failure, assuming successful\x94.'), '4f4afffe-c8eb-40a6-a560-1bb70bfd4e67': pickle.loads(b'\x80\x04\x95\x8a\x01\x00\x00\x00\x00\x00\x00\x8c%griptape.artifacts.image_url_artifact\x94\x8c\x10ImageUrlArtifact\x94\x93\x94)\x81\x94}\x94(\x8c\x04type\x94\x8c\x10ImageUrlArtifact\x94\x8c\x0bmodule_name\x94\x8c%griptape.artifacts.image_url_artifact\x94\x8c\x02id\x94\x8c 8d7c3087e5824430ba2dedb9cb141aba\x94\x8c\treference\x94N\x8c\x04meta\x94}\x94\x8c\x04name\x94\x8c\x19flux_image_1766003719.jpg\x94\x8c\x16encoding_error_handler\x94\x8c\x06strict\x94\x8c\x08encoding\x94\x8c\x05utf-8\x94\x8c\x05value\x94\x8cShttp://localhost:8124/workspace/static_files/flux_image_1766003719.jpg?t=1766003719\x94ub.'), '0cb90383-9b45-4182-be04-38187b0e1e07': pickle.loads(b'\x80\x04\x95H\x01\x00\x00\x00\x00\x00\x00XA\x01\x00\x00# Flux 2 - Magazine Cover\n\nThis workflow demonstrates the use of Black Forest Labs Flux 2 Text to Image workflow.\n\nIt uses an Agent with OpenAI gpt-4.1-mini to help develop a powerful prompt to give the Image Generation model.\n\nThen we grab an aspect ratio and pass that to the Image Generation node to generate an image.\x94.'), 'b827b3ae-5f5d-4355-ad80-35f99d28e35e': pickle.loads(b'\x80\x04\x95P\x00\x00\x00\x00\x00\x00\x00\x8cL# Inputs\n\nProvide a *subject* and a *decade* to create a magazine cover for.\x94.'), 'f5929c08-b15e-48b6-b3c4-3bd01166ca88': pickle.loads(b'\x80\x04\x95D\x00\x00\x00\x00\x00\x00\x00\x8c@This node merges text into a single message to send to an agent.\x94.'), 'd9facc85-46b0-4d30-915d-cd0387353308': pickle.loads(b'\x80\x04\x95\xbb\x00\x00\x00\x00\x00\x00\x00\x8c\xb7# Agent Behavior\n\nThese rules are adapted from the [Flux.2 Prompting Guide](https://docs.bfl.ai/guides/prompting_guide_flux2) and are given to the agent to help guide their responses.\x94.'), '10453ae0-5090-4f51-a14c-8cb40ad7c7b5': pickle.loads(b'\x80\x04\x95\x95\x00\x00\x00\x00\x00\x00\x00\x8c\x91Using Agents to create image generation prompts helps ensure consistency in the prompt, and allows you to be a bit more free with how you prompt.\x94.'), '65923739-64aa-4476-852e-7f4ad55e92fe': pickle.loads(b'\x80\x04\x95K\x00\x00\x00\x00\x00\x00\x00\x8cGUse the Aspect Ratio node to pick a nice width and height for the image\x94.'), '22efc013-bcd0-43f0-9e2c-093583beae27': pickle.loads(b"\x80\x04\x95'\x00\x00\x00\x00\x00\x00\x00\x8c#Generate the image using flux-2-max\x94."), 'ff1b9511-dff4-4025-84f9-42f3da79eba1': pickle.loads(b'\x80\x04\x95\x10\x00\x00\x00\x00\x00\x00\x00\x8c\x0cgpt-4.1-mini\x94.'), 'f6f77215-6e96-44e5-8fef-1d10fe1a0a59': pickle.loads(b'\x80\x04\x95\x08\x01\x00\x00\x00\x00\x00\x00X\x01\x01\x00\x00Create a magazine cover from specified decade of the following subject. Include an interesting title and some article titles and text. \n\nMake the image and article titles authentic to the time period. \n\nOutput only the Image Generation Prompt in JSON format\x94.'), '6b61842f-9ce6-424d-aa91-56e047ee6683': pickle.loads(b'\x80\x04]\x94.'), '0d41c585-bfd9-44fb-9525-2d2d401b144d': pickle.loads(b'\x80\x04\x95J\x10\x00\x00\x00\x00\x00\x00]\x94\x8c\x16griptape.rules.ruleset\x94\x8c\x07Ruleset\x94\x93\x94)\x81\x94}\x94(\x8c\x04type\x94\x8c\x07Ruleset\x94\x8c\x0bmodule_name\x94\x8c\x16griptape.rules.ruleset\x94\x8c\x02id\x94\x8c aa0c1a894a1e45a582f4d821f9f45595\x94\x8c\x04name\x94\x8c\x16Flux 2 Prompting Guide\x94\x8c\x0eruleset_driver\x94\x8c-griptape.drivers.ruleset.local_ruleset_driver\x94\x8c\x12LocalRulesetDriver\x94\x93\x94)\x81\x94}\x94(h\x06\x8c\x12LocalRulesetDriver\x94h\x08\x8c-griptape.drivers.ruleset.local_ruleset_driver\x94\x8c\x0fraise_not_found\x94\x88\x8c\x0bpersist_dir\x94Nub\x8c\x04meta\x94}\x94\x8c\x05rules\x94]\x94(\x8c\x13griptape.rules.rule\x94\x8c\x04Rule\x94\x93\x94)\x81\x94}\x94(h\x06\x8c\x04Rule\x94h\x08\x8c\x13griptape.rules.rule\x94h\x18}\x94\x8c\x05value\x94\x8c\x1f**Rules for Crafting Prompts:**\x94ubh\x1e)\x81\x94}\x94(h\x06h!h\x08h"h\x18}\x94h$\x8c\xa71. **Focus on Positive Descriptions**  \n   - Avoid negative prompts. Describe what you want clearly.  \n   - Example: Use "sharp focus throughout" instead of "no blur."\x94ubh\x1e)\x81\x94}\x94(h\x06h!h\x08h"h\x18}\x94h$\x8c\xee2. **Prompt Structure**  \n   - Follow: **Subject + Action + Style + Context**  \n   - Example:  \n     - *"Black cat hiding behind a watermelon slice, professional studio shot, bright red and turquoise background with summer mystery vibe."*\x94ubh\x1e)\x81\x94}\x94(h\x06h!h\x08h"h\x18}\x94h$\x8c\x983. **Prioritize Word Order**  \n   - Place the most important details first: **Main subject \xe2\x86\x92 Key action \xe2\x86\x92 Style \xe2\x86\x92 Context \xe2\x86\x92 Secondary details.**\x94ubh\x1e)\x81\x94}\x94(h\x06h!h\x08h"h\x18}\x94h$\x8c\xb34. **Prompt Length**  \n   - **Short (10\xe2\x80\x9330 words)**: Quick concepts.  \n   - **Medium (30\xe2\x80\x9380 words)**: Ideal for most prompts.  \n   - **Long (80+ words)**: For detailed scenes.\x94ubh\x1e)\x81\x94}\x94(h\x06h!h\x08h"h\x18}\x94h$\x8c\xab5. **Photorealistic Styles**  \n   - Reference eras, cameras, or techniques for specific looks.  \n   - Example: *"Shot on Kodak Portra 400, natural grain, organic colors."*\x94ubh\x1e)\x81\x94}\x94(h\x06h!h\x08h"h\x18}\x94h$\x8c\xb36. **Camera and Lens Details**  \n   - Specify models, lenses, and settings for realism.  \n   - Example: *"Canon 5D Mark IV, 24-70mm at 35mm, golden hour, shallow depth of field."*\x94ubh\x1e)\x81\x94}\x94(h\x06h!h\x08h"h\x18}\x94h$\x8c\xc27. **Typography and Design**  \n   - Use quotation marks for text elements and specify placement, style, and color.  \n   - Example: *"The text \'OPEN\' appears in red neon letters above the door."*\x94ubh\x1e)\x81\x94}\x94(h\x06h!h\x08h"h\x18}\x94h$\x8c\x9a8. **Precise Colors with HEX Codes**  \n   - Use hex codes for exact color matching.  \n   - Example: *"The vase is #02eb3c, with a background of #1a1a2e."*\x94ubh\x1e)\x81\x94}\x94(h\x06h!h\x08h"h\x18}\x94h$\x8c\xcb9. **Multi-Language Support**  \n   - Prompt in your native language for cultural authenticity.  \n   - Example: *"Un march\xc3\xa9 alimentaire dans la campagne normande, lever de soleil, temps un peu brumeux."*\x94ubh\x1e)\x81\x94}\x94(h\x06h!h\x08h"h\x18}\x94h$X)\x01\x00\x0010. **Comic Strips and Sequential Art**  \n    - Maintain consistent character descriptions across panels.  \n    - Example:  \n      - Panel 1: *"Worried scientist typing on glowing holographic keyboard."*  \n      - Panel 2: *"Diffusion Man glows with swirling gradients of purple and blue energy."*\x94ubh\x1e)\x81\x94}\x94(h\x06h!h\x08h"h\x18}\x94h$X\xa6\x02\x00\x0011. **JSON for Complex Scenes**  \n    - Use structured JSON for precise control.  \n    - Example:  \n      ```json\n      {\n        "scene": "Professional studio product photography setup",\n        "subjects": [\n          {\n            "description": "Minimalist ceramic coffee mug with steam rising",\n            "position": "Center foreground",\n            "color_palette": ["matte black ceramic"]\n          }\n        ],\n        "style": "Ultra-realistic product photography",\n        "lighting": "Softbox setup creating diffused highlights",\n        "camera": {\n          "angle": "high angle",\n          "lens-mm": 85,\n          "f-number": "f/5.6"\n        }\n      }\n      ```\x94ubh\x1e)\x81\x94}\x94(h\x06h!h\x08h"h\x18}\x94h$X-\x01\x00\x0012. **Aspect Ratios and Resolution**  \n    - Choose aspect ratios based on use case:  \n      - **1:1**: Social media.  \n      - **16:9**: Cinematic shots.  \n      - **9:16**: Mobile content.  \n      - **4:3**: Magazine layouts.  \n      - **21:9**: Panoramas.  \n    - Recommended resolution: Up to 2MP.\x94ubh\x1e)\x81\x94}\x94(h\x06h!h\x08h"h\x18}\x94h$Xw\x01\x00\x0013. **Best Practices Summary**  \n    - **Describe What You Want**: Focus on desired elements.  \n    - **Be Specific with Colors**: Use hex codes for precision.  \n    - **Reference Camera and Style**: Specify models and techniques.  \n    - **Use Native Languages**: Prompt in culturally relevant languages.  \n    - **Structure for Control**: Use JSON for detailed automation.\n\x94ubeuba.'), 'fba1925f-0b86-4d75-9ae3-57e49cb48a23': pickle.loads(b'\x80\x04\x95\x04\x00\x00\x00\x00\x00\x00\x00\x8c\x00\x94.'), '3f809aae-7ea8-4019-ba6b-711db0420bf9': pickle.loads(b'\x80\x04\x95\x0e\x00\x00\x00\x00\x00\x00\x00\x8c\nflux-2-max\x94.'), 'c1a63745-7bfd-4926-b2ce-c493d6117125': pickle.loads(b'\x80\x04]\x94.'), 'aacffa70-7ec3-4739-81a8-e26885876c8b': pickle.loads(b'\x80\x04\x95\x04\x00\x00\x00\x00\x00\x00\x00M\x80\x03.'), '6116049e-0529-4ed6-8974-174acf9f491a': pickle.loads(b'\x80\x04\x95\x04\x00\x00\x00\x00\x00\x00\x00M\x80\x04.'), '7d703187-236f-43b2-a5ad-2c0e70313904': pickle.loads(b'\x80\x04K*.'), '63f65a7b-2bac-44ee-9e18-b3d1d6f4f132': pickle.loads(b'\x80\x04\x95\x08\x00\x00\x00\x00\x00\x00\x00\x8c\x04jpeg\x94.'), '4ae93334-b14c-4ce8-86c6-e7e1e650a9c5': pickle.loads(b'\x80\x04\x95\x15\x00\x00\x00\x00\x00\x00\x00\x8c\x11least restrictive\x94.'), '95130c1a-554d-4717-8524-b9aca9155230': pickle.loads(b'\x80\x04K2.'), 'c8df45a5-1dc6-42a6-8705-e54ebf8e7f5a': pickle.loads(b'\x80\x04\x95\n\x00\x00\x00\x00\x00\x00\x00G@\x12\x00\x00\x00\x00\x00\x00.'), 'f0ff9b03-c6e6-4789-82e9-1acb8aa2d46d': pickle.loads(b'\x80\x04\x95\x12\x00\x00\x00\x00\x00\x00\x00\x8c\x0e896x1152 (7:9)\x94.'), '520af8c8-e0ec-41df-bac9-805221c746c3': pickle.loads(b'\x80\x04\x95\n\x00\x00\x00\x00\x00\x00\x00G@\x85UUUUUU.'), '1173388d-cdf0-43dc-a25f-78bca7e32e3c': pickle.loads(b'\x80\x04\x95\n\x00\x00\x00\x00\x00\x00\x00G@\x90\x00\x00\x00\x00\x00\x00.'), 'e184714b-70e5-410d-9f2f-7289d6818a3b': pickle.loads(b'\x80\x04\x95\x07\x00\x00\x00\x00\x00\x00\x00\x8c\x032:3\x94.'), '1214ffea-892a-47b4-8643-56688d9ca071': pickle.loads(b'\x80\x04K\x01.'), '229a83a6-0d84-4ef4-804f-495ebeaf3d3c': pickle.loads(b'\x80\x04\x95\x04\x00\x00\x00\x00\x00\x00\x00M\x00\x04.'), '745a6fff-e8d9-40e8-b86d-9a203ed4a4b8': pickle.loads(b'\x80\x04\x95\x07\x00\x00\x00\x00\x00\x00\x00\x8c\x031:1\x94.'), '50fa3b84-fcde-4597-9a2a-fec64b229877': pickle.loads(b'\x80\x04\x95\n\x00\x00\x00\x00\x00\x00\x00G?\xe5UUUUUU.'), '6357fefc-20a5-4ee0-b5aa-46a8f4f899ec': pickle.loads(b'\x80\x04\x95\x0c\x00\x00\x00\x00\x00\x00\x00\x8c\x08896x1152\x94.'), '38520dea-1122-4c80-9802-e5727725befe': pickle.loads(b'\x80\x04\x95\x16\x00\x00\x00\x00\x00\x00\x00\x8c\x12Output the results\x94.')}

'# Create the Flow, then do work within it as context.'

flow0_name = GriptapeNodes.handle_request(CreateFlowRequest(parent_flow_name=None, flow_name='ControlFlow_1', set_as_new_context=False, metadata={})).flow_name

with GriptapeNodes.ContextManager().flow(flow0_name):
    node0_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='StartFlow', specific_library_name='Griptape Nodes Library', node_name='Start Flow', metadata={'position': {'x': -1061.5751704894092, 'y': 296.93529465485886}, 'tempId': 'placing-1765996350930-qa8fpl', 'library_node_metadata': NodeMetadata(category='workflows', description='Define the start of a workflow and pass parameters into the flow', display_name='Start Flow', tags=None, icon=None, color=None, group='create', deprecation=None, is_node_group=None), 'library': 'Griptape Nodes Library', 'node_type': 'StartFlow', 'showaddparameter': True, 'size': {'width': 600, 'height': 347}, 'category': 'workflows'}, resolution='resolved', initial_setup=True)).node_name
    with GriptapeNodes.ContextManager().node(node0_name):
        GriptapeNodes.handle_request(AddParameterToNodeRequest(parameter_name='text', default_value='', tooltip='New parameter', type='str', input_types=['any'], output_type='str', ui_options={'multiline': True, 'placeholder_text': 'The text content to display', 'hide_label': False, 'hide_property': False, 'is_custom': True, 'is_user_added': True, 'hide': False, 'display_name': 'subject'}, mode_allowed_input=True, mode_allowed_property=True, mode_allowed_output=True, parent_container_name='', initial_setup=True))
        GriptapeNodes.handle_request(AddParameterToNodeRequest(parameter_name='text_1', default_value='', tooltip='New parameter', type='str', input_types=['any'], output_type='str', ui_options={'multiline': True, 'placeholder_text': 'The text content to display', 'hide_label': False, 'hide_property': False, 'is_custom': True, 'is_user_added': True, 'hide': False, 'display_name': 'decade'}, mode_allowed_input=True, mode_allowed_property=True, mode_allowed_output=True, parent_container_name='', initial_setup=True))
    node1_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='Ruleset', specific_library_name='Griptape Nodes Library', node_name='Ruleset_1', metadata={'position': {'x': -140.8654069738245, 'y': 1134.5360838384356}, 'tempId': 'placing-1765998085117-ktqra', 'library_node_metadata': {'category': 'agents/rules', 'description': 'Give an agent a set of rules and behaviors to follow'}, 'library': 'Griptape Nodes Library', 'node_type': 'Ruleset', 'showaddparameter': False, 'size': {'width': 864, 'height': 410}, 'category': 'agents/rules'}, resolution='resolved', initial_setup=True)).node_name
    node2_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='MergeTexts', specific_library_name='Griptape Nodes Library', node_name='Merge Texts', metadata={'position': {'x': -140.8654069738245, 'y': 258.80785141297656}, 'tempId': 'placing-1766002459782-pzdym9', 'library_node_metadata': {'category': 'text', 'description': 'MergeTexts node'}, 'library': 'Griptape Nodes Library', 'node_type': 'MergeTexts', 'showaddparameter': False, 'size': {'width': 600, 'height': 500}, 'category': 'text', 'empty_merge_string_migrated': True}, resolution='resolved', initial_setup=True)).node_name
    node3_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='EndFlow', specific_library_name='Griptape Nodes Library', node_name='End Flow', metadata={'position': {'x': 3803.156063032572, 'y': 258.80785141297656}, 'tempId': 'placing-1766003522860-5ouiyv', 'library_node_metadata': {'category': 'workflows', 'description': 'Define the end of a workflow and return parameters from the flow'}, 'library': 'Griptape Nodes Library', 'node_type': 'EndFlow', 'showaddparameter': True, 'size': {'width': 945, 'height': 1244}, 'category': 'workflows'}, initial_setup=True)).node_name
    with GriptapeNodes.ContextManager().node(node3_name):
        GriptapeNodes.handle_request(AddParameterToNodeRequest(parameter_name='image_url', default_value='', tooltip='New parameter', type='ImageUrlArtifact', input_types=['ImageUrlArtifact'], output_type='ImageUrlArtifact', ui_options={'is_full_width': True, 'pulse_on_run': True, 'is_custom': True, 'is_user_added': True}, mode_allowed_input=True, mode_allowed_property=True, mode_allowed_output=True, parent_container_name='', initial_setup=True))
    node4_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='Note', specific_library_name='Griptape Nodes Library', node_name='Workflow Description', metadata={'position': {'x': -1061.5751704894092, 'y': -336.52399023132017}, 'tempId': 'placing-1766158799711-dw55dh', 'library_node_metadata': {'category': 'misc', 'description': 'Create a note node to provide helpful context in your workflow'}, 'library': 'Griptape Nodes Library', 'node_type': 'Note', 'showaddparameter': False, 'size': {'width': 600, 'height': 328}, 'category': 'misc'}, initial_setup=True)).node_name
    node5_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='Note', specific_library_name='Griptape Nodes Library', node_name='Step 1', metadata={'position': {'x': -1061.5751704894092, 'y': 66.80785141297656}, 'tempId': 'placing-1766003334530-pnkgh', 'library_node_metadata': NodeMetadata(category='misc', description='Create a note node to provide helpful context in your workflow', display_name='Note', tags=None, icon='notepad-text', color=None, group='create', deprecation=None, is_node_group=None), 'library': 'Griptape Nodes Library', 'node_type': 'Note', 'showaddparameter': False, 'size': {'width': 600, 'height': 192}, 'category': 'misc'}, resolution='resolved', initial_setup=True)).node_name
    node6_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='Note', specific_library_name='Griptape Nodes Library', node_name='Step 2', metadata={'position': {'x': -140.8654069738245, 'y': 66.80785141297656}, 'tempId': 'placing-1766003370124-fo9hq', 'library_node_metadata': {'category': 'misc', 'description': 'Create a note node to provide helpful context in your workflow'}, 'library': 'Griptape Nodes Library', 'node_type': 'Note', 'showaddparameter': False, 'size': {'width': 602, 'height': 132}, 'category': 'misc'}, resolution='resolved', initial_setup=True)).node_name
    node7_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='Note', specific_library_name='Griptape Nodes Library', node_name='Step 3', metadata={'position': {'x': -140.8654069738245, 'y': 924.8103879646247}, 'tempId': 'placing-1766003265679-b4mek', 'library_node_metadata': {'category': 'misc', 'description': 'Create a note node to provide helpful context in your workflow'}, 'library': 'Griptape Nodes Library', 'node_type': 'Note', 'showaddparameter': False, 'size': {'width': 600, 'height': 192}, 'category': 'misc'}, resolution='resolved', initial_setup=True)).node_name
    node8_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='Note', specific_library_name='Griptape Nodes Library', node_name='Step 4', metadata={'position': {'x': 973.7080171132445, 'y': 66.80785141297656}, 'tempId': 'placing-1766003370124-fo9hq', 'library_node_metadata': {'category': 'misc', 'description': 'Create a note node to provide helpful context in your workflow'}, 'library': 'Griptape Nodes Library', 'node_type': 'Note', 'showaddparameter': False, 'size': {'width': 600, 'height': 163}, 'category': 'misc'}, resolution='resolved', initial_setup=True)).node_name
    node9_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='Note', specific_library_name='Griptape Nodes Library', node_name='Step 5', metadata={'position': {'x': 1879.4831944045718, 'y': 66.80785141297656}, 'tempId': 'placing-1766003370124-fo9hq', 'library_node_metadata': {'category': 'misc', 'description': 'Create a note node to provide helpful context in your workflow'}, 'library': 'Griptape Nodes Library', 'node_type': 'Note', 'showaddparameter': False, 'size': {'width': 600, 'height': 149}, 'category': 'misc'}, initial_setup=True)).node_name
    node10_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='Note', specific_library_name='Griptape Nodes Library', node_name='Step 6', metadata={'position': {'x': 2748.7852329833977, 'y': 66.80785141297656}, 'tempId': 'placing-1766003370124-fo9hq', 'library_node_metadata': {'category': 'misc', 'description': 'Create a note node to provide helpful context in your workflow'}, 'library': 'Griptape Nodes Library', 'node_type': 'Note', 'showaddparameter': False, 'size': {'width': 722, 'height': 153}, 'category': 'misc'}, initial_setup=True)).node_name
    node11_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='Agent', specific_library_name='Griptape Nodes Library', node_name='Agent_1', metadata={'library_node_metadata': NodeMetadata(category='agents', description='Creates an AI agent with conversation memory and the ability to use tools', display_name='Agent', tags=None, icon=None, color=None, group='create', deprecation=None, is_node_group=None), 'library': 'Griptape Nodes Library', 'node_type': 'Agent', 'position': {'x': 973.7080171132445, 'y': 258.80785141297656}, 'size': {'width': 600, 'height': 1179}}, initial_setup=True)).node_name
    with GriptapeNodes.ContextManager().node(node11_name):
        GriptapeNodes.handle_request(AlterParameterDetailsRequest(parameter_name='additional_context', mode_allowed_property=False, initial_setup=True))
        GriptapeNodes.handle_request(AddParameterToNodeRequest(parameter_name='rulesets_ParameterListUniqueParamID_cfcb1fdadf364b38b44e1e31d82555ad', default_value=[], tooltip='Rulesets to apply to the agent to control its behavior.', type='Ruleset', input_types=['Ruleset', 'list[Ruleset]'], output_type='Ruleset', ui_options={}, mode_allowed_input=True, mode_allowed_property=False, mode_allowed_output=False, is_user_defined=True, settable=True, parent_container_name='rulesets', initial_setup=True))
    node12_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='Flux2ImageGeneration', specific_library_name='Griptape Nodes Library', node_name='FLUX.2 Image Generation', metadata={'library_node_metadata': {'category': 'image', 'description': 'Generate images using FLUX.2 models via Griptape model proxy'}, 'library': 'Griptape Nodes Library', 'node_type': 'Flux2ImageGeneration', 'position': {'x': 2748.7852329833977, 'y': 258.80785141297656}, 'size': {'width': 725, 'height': 1245}, 'showaddparameter': False, 'category': 'image'}, initial_setup=True)).node_name
    node13_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='AspectRatio', specific_library_name='Griptape Nodes Library', node_name='Aspect Ratio', metadata={'position': {'x': 1879.4831944045718, 'y': 258.80785141297656}, 'tempId': 'placing-1766159102639-77pch', 'library_node_metadata': {'category': 'image', 'description': 'Calculate aspect ratios with preset selection and dimension modifiers'}, 'library': 'Griptape Nodes Library', 'node_type': 'AspectRatio', 'showaddparameter': False, 'size': {'width': 600, 'height': 955}, 'category': 'image'}, initial_setup=True)).node_name
    node14_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='Note', specific_library_name='Griptape Nodes Library', node_name='Step 7', metadata={'position': {'x': 3803.156063032572, 'y': 66.80785141297656}, 'tempId': 'placing-1766003370124-fo9hq', 'library_node_metadata': {'category': 'misc', 'description': 'Create a note node to provide helpful context in your workflow'}, 'library': 'Griptape Nodes Library', 'node_type': 'Note', 'showaddparameter': False, 'size': {'width': 722, 'height': 153}, 'category': 'misc'}, initial_setup=True)).node_name
    GriptapeNodes.handle_request(CreateConnectionRequest(source_node_name=node0_name, source_parameter_name='text', target_node_name=node2_name, target_parameter_name='input_2', initial_setup=True))
    GriptapeNodes.handle_request(CreateConnectionRequest(source_node_name=node0_name, source_parameter_name='text_1', target_node_name=node2_name, target_parameter_name='input_4', initial_setup=True))
    GriptapeNodes.handle_request(CreateConnectionRequest(source_node_name=node2_name, source_parameter_name='output', target_node_name=node11_name, target_parameter_name='additional_context', initial_setup=True))
    GriptapeNodes.handle_request(CreateConnectionRequest(source_node_name=node1_name, source_parameter_name='ruleset', target_node_name=node11_name, target_parameter_name='rulesets_ParameterListUniqueParamID_cfcb1fdadf364b38b44e1e31d82555ad', initial_setup=True))
    GriptapeNodes.handle_request(CreateConnectionRequest(source_node_name=node11_name, source_parameter_name='output', target_node_name=node12_name, target_parameter_name='prompt', initial_setup=True))
    GriptapeNodes.handle_request(CreateConnectionRequest(source_node_name=node12_name, source_parameter_name='image_url', target_node_name=node3_name, target_parameter_name='image_url', initial_setup=True))
    GriptapeNodes.handle_request(CreateConnectionRequest(source_node_name=node13_name, source_parameter_name='final_width', target_node_name=node12_name, target_parameter_name='width', initial_setup=True))
    GriptapeNodes.handle_request(CreateConnectionRequest(source_node_name=node13_name, source_parameter_name='final_height', target_node_name=node12_name, target_parameter_name='height', initial_setup=True))
    with GriptapeNodes.ContextManager().node(node0_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='text', node_name=node0_name, value=top_level_unique_values_dict['fa50565b-924f-4b74-9edc-3ba796341fb5'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='text_1', node_name=node0_name, value=top_level_unique_values_dict['17187494-76c6-4fbe-ad16-73ffe3a3c3a0'], initial_setup=True, is_output=False))
    with GriptapeNodes.ContextManager().node(node1_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='name', node_name=node1_name, value=top_level_unique_values_dict['8970c9b2-8220-4ce8-beec-eb13c8f7d337'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='rules', node_name=node1_name, value=top_level_unique_values_dict['7a06b327-8d79-45df-b853-46b9bfb36cc5'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='ruleset', node_name=node1_name, value=top_level_unique_values_dict['fe887c4a-b7d9-487e-9745-10db25cbb0ae'], initial_setup=True, is_output=True))
    with GriptapeNodes.ContextManager().node(node2_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='input_1', node_name=node2_name, value=top_level_unique_values_dict['21509fc4-866c-4a7f-a503-a1af8a677513'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='input_2', node_name=node2_name, value=top_level_unique_values_dict['fa50565b-924f-4b74-9edc-3ba796341fb5'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='input_3', node_name=node2_name, value=top_level_unique_values_dict['35ce2ed2-a9ac-4ee1-8282-b9b7f56dca2f'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='input_4', node_name=node2_name, value=top_level_unique_values_dict['17187494-76c6-4fbe-ad16-73ffe3a3c3a0'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='merge_string', node_name=node2_name, value=top_level_unique_values_dict['52e340f1-291b-4bb2-acc8-3a6205598ba0'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='whitespace', node_name=node2_name, value=top_level_unique_values_dict['2b7350c7-e59d-4634-a125-d8eba82936b0'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='output', node_name=node2_name, value=top_level_unique_values_dict['0b766ff0-acb8-48aa-8f03-116ae28f72e2'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='output', node_name=node2_name, value=top_level_unique_values_dict['0b766ff0-acb8-48aa-8f03-116ae28f72e2'], initial_setup=True, is_output=True))
    with GriptapeNodes.ContextManager().node(node3_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='was_successful', node_name=node3_name, value=top_level_unique_values_dict['e1d1d1ba-adbd-4183-bfa8-2e811bea20d2'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='was_successful', node_name=node3_name, value=top_level_unique_values_dict['e1d1d1ba-adbd-4183-bfa8-2e811bea20d2'], initial_setup=True, is_output=True))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='result_details', node_name=node3_name, value=top_level_unique_values_dict['b613d2a8-c4ed-462d-b6fe-b00fc4dc8b94'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='result_details', node_name=node3_name, value=top_level_unique_values_dict['b613d2a8-c4ed-462d-b6fe-b00fc4dc8b94'], initial_setup=True, is_output=True))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='image_url', node_name=node3_name, value=top_level_unique_values_dict['4f4afffe-c8eb-40a6-a560-1bb70bfd4e67'], initial_setup=True, is_output=True))
    with GriptapeNodes.ContextManager().node(node4_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='note', node_name=node4_name, value=top_level_unique_values_dict['0cb90383-9b45-4182-be04-38187b0e1e07'], initial_setup=True, is_output=False))
    with GriptapeNodes.ContextManager().node(node5_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='note', node_name=node5_name, value=top_level_unique_values_dict['b827b3ae-5f5d-4355-ad80-35f99d28e35e'], initial_setup=True, is_output=False))
    with GriptapeNodes.ContextManager().node(node6_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='note', node_name=node6_name, value=top_level_unique_values_dict['f5929c08-b15e-48b6-b3c4-3bd01166ca88'], initial_setup=True, is_output=False))
    with GriptapeNodes.ContextManager().node(node7_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='note', node_name=node7_name, value=top_level_unique_values_dict['d9facc85-46b0-4d30-915d-cd0387353308'], initial_setup=True, is_output=False))
    with GriptapeNodes.ContextManager().node(node8_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='note', node_name=node8_name, value=top_level_unique_values_dict['10453ae0-5090-4f51-a14c-8cb40ad7c7b5'], initial_setup=True, is_output=False))
    with GriptapeNodes.ContextManager().node(node9_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='note', node_name=node9_name, value=top_level_unique_values_dict['65923739-64aa-4476-852e-7f4ad55e92fe'], initial_setup=True, is_output=False))
    with GriptapeNodes.ContextManager().node(node10_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='note', node_name=node10_name, value=top_level_unique_values_dict['22efc013-bcd0-43f0-9e2c-093583beae27'], initial_setup=True, is_output=False))
    with GriptapeNodes.ContextManager().node(node11_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='model', node_name=node11_name, value=top_level_unique_values_dict['ff1b9511-dff4-4025-84f9-42f3da79eba1'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='prompt', node_name=node11_name, value=top_level_unique_values_dict['f6f77215-6e96-44e5-8fef-1d10fe1a0a59'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='additional_context', node_name=node11_name, value=top_level_unique_values_dict['0b766ff0-acb8-48aa-8f03-116ae28f72e2'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='tools', node_name=node11_name, value=top_level_unique_values_dict['6b61842f-9ce6-424d-aa91-56e047ee6683'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='rulesets', node_name=node11_name, value=top_level_unique_values_dict['0d41c585-bfd9-44fb-9525-2d2d401b144d'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='rulesets_ParameterListUniqueParamID_cfcb1fdadf364b38b44e1e31d82555ad', node_name=node11_name, value=top_level_unique_values_dict['fe887c4a-b7d9-487e-9745-10db25cbb0ae'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='output', node_name=node11_name, value=top_level_unique_values_dict['fba1925f-0b86-4d75-9ae3-57e49cb48a23'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='include_details', node_name=node11_name, value=top_level_unique_values_dict['2b7350c7-e59d-4634-a125-d8eba82936b0'], initial_setup=True, is_output=False))
    with GriptapeNodes.ContextManager().node(node12_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='model', node_name=node12_name, value=top_level_unique_values_dict['3f809aae-7ea8-4019-ba6b-711db0420bf9'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='prompt', node_name=node12_name, value=top_level_unique_values_dict['fba1925f-0b86-4d75-9ae3-57e49cb48a23'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='input_images', node_name=node12_name, value=top_level_unique_values_dict['c1a63745-7bfd-4926-b2ce-c493d6117125'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='width', node_name=node12_name, value=top_level_unique_values_dict['aacffa70-7ec3-4739-81a8-e26885876c8b'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='height', node_name=node12_name, value=top_level_unique_values_dict['6116049e-0529-4ed6-8974-174acf9f491a'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='randomize_seed', node_name=node12_name, value=top_level_unique_values_dict['2b7350c7-e59d-4634-a125-d8eba82936b0'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='seed', node_name=node12_name, value=top_level_unique_values_dict['7d703187-236f-43b2-a5ad-2c0e70313904'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='output_format', node_name=node12_name, value=top_level_unique_values_dict['63f65a7b-2bac-44ee-9e18-b3d1d6f4f132'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='safety_tolerance', node_name=node12_name, value=top_level_unique_values_dict['4ae93334-b14c-4ce8-86c6-e7e1e650a9c5'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='steps', node_name=node12_name, value=top_level_unique_values_dict['95130c1a-554d-4717-8524-b9aca9155230'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='guidance', node_name=node12_name, value=top_level_unique_values_dict['c8df45a5-1dc6-42a6-8705-e54ebf8e7f5a'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='was_successful', node_name=node12_name, value=top_level_unique_values_dict['2b7350c7-e59d-4634-a125-d8eba82936b0'], initial_setup=True, is_output=False))
    with GriptapeNodes.ContextManager().node(node13_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='preset', node_name=node13_name, value=top_level_unique_values_dict['f0ff9b03-c6e6-4789-82e9-1acb8aa2d46d'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='width', node_name=node13_name, value=top_level_unique_values_dict['aacffa70-7ec3-4739-81a8-e26885876c8b'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='internal_width_float', node_name=node13_name, value=top_level_unique_values_dict['520af8c8-e0ec-41df-bac9-805221c746c3'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='height', node_name=node13_name, value=top_level_unique_values_dict['6116049e-0529-4ed6-8974-174acf9f491a'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='internal_height_float', node_name=node13_name, value=top_level_unique_values_dict['1173388d-cdf0-43dc-a25f-78bca7e32e3c'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='ratio_str', node_name=node13_name, value=top_level_unique_values_dict['e184714b-70e5-410d-9f2f-7289d6818a3b'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='upscale_value', node_name=node13_name, value=top_level_unique_values_dict['1214ffea-892a-47b4-8643-56688d9ca071'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='swap_dimensions', node_name=node13_name, value=top_level_unique_values_dict['2b7350c7-e59d-4634-a125-d8eba82936b0'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='final_width', node_name=node13_name, value=top_level_unique_values_dict['229a83a6-0d84-4ef4-804f-495ebeaf3d3c'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='final_width', node_name=node13_name, value=top_level_unique_values_dict['aacffa70-7ec3-4739-81a8-e26885876c8b'], initial_setup=True, is_output=True))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='final_height', node_name=node13_name, value=top_level_unique_values_dict['229a83a6-0d84-4ef4-804f-495ebeaf3d3c'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='final_height', node_name=node13_name, value=top_level_unique_values_dict['6116049e-0529-4ed6-8974-174acf9f491a'], initial_setup=True, is_output=True))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='final_ratio_str', node_name=node13_name, value=top_level_unique_values_dict['745a6fff-e8d9-40e8-b86d-9a203ed4a4b8'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='final_ratio_str', node_name=node13_name, value=top_level_unique_values_dict['e184714b-70e5-410d-9f2f-7289d6818a3b'], initial_setup=True, is_output=True))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='final_ratio_decimal', node_name=node13_name, value=top_level_unique_values_dict['50fa3b84-fcde-4597-9a2a-fec64b229877'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='final_ratio_decimal', node_name=node13_name, value=top_level_unique_values_dict['50fa3b84-fcde-4597-9a2a-fec64b229877'], initial_setup=True, is_output=True))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='was_successful', node_name=node13_name, value=top_level_unique_values_dict['e1d1d1ba-adbd-4183-bfa8-2e811bea20d2'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='was_successful', node_name=node13_name, value=top_level_unique_values_dict['e1d1d1ba-adbd-4183-bfa8-2e811bea20d2'], initial_setup=True, is_output=True))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='result_details', node_name=node13_name, value=top_level_unique_values_dict['6357fefc-20a5-4ee0-b5aa-46a8f4f899ec'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='result_details', node_name=node13_name, value=top_level_unique_values_dict['6357fefc-20a5-4ee0-b5aa-46a8f4f899ec'], initial_setup=True, is_output=True))
    with GriptapeNodes.ContextManager().node(node14_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='note', node_name=node14_name, value=top_level_unique_values_dict['38520dea-1122-4c80-9802-e5727725befe'], initial_setup=True, is_output=False))

def _ensure_workflow_context():
    context_manager = GriptapeNodes.ContextManager()
    if not context_manager.has_current_flow():
        top_level_flow_request = GetTopLevelFlowRequest()
        top_level_flow_result = GriptapeNodes.handle_request(top_level_flow_request)
        if isinstance(top_level_flow_result, GetTopLevelFlowResultSuccess) and top_level_flow_result.flow_name is not None:
            flow_manager = GriptapeNodes.FlowManager()
            flow_obj = flow_manager.get_flow_by_name(top_level_flow_result.flow_name)
            context_manager.push_flow(flow_obj)

def execute_workflow(input: dict, storage_backend: str='local', workflow_executor: WorkflowExecutor | None=None, pickle_control_flow_result: bool=False) -> dict | None:
    return asyncio.run(aexecute_workflow(input=input, storage_backend=storage_backend, workflow_executor=workflow_executor, pickle_control_flow_result=pickle_control_flow_result))

async def aexecute_workflow(input: dict, storage_backend: str='local', workflow_executor: WorkflowExecutor | None=None, pickle_control_flow_result: bool=False) -> dict | None:
    _ensure_workflow_context()
    storage_backend_enum = StorageBackend(storage_backend)
    workflow_executor = workflow_executor or LocalWorkflowExecutor(storage_backend=storage_backend_enum)
    async with workflow_executor as executor:
        await executor.arun(flow_input=input, pickle_control_flow_result=pickle_control_flow_result)
    return executor.output

if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    parser.add_argument('--storage-backend', choices=['local', 'gtc'], default='local', help="Storage backend to use: 'local' for local filesystem or 'gtc' for Griptape Cloud")
    parser.add_argument('--json-input', default=None, help='JSON string containing parameter values. Takes precedence over individual parameter arguments if provided.')
    parser.add_argument('--exec_out', default=None, help='Connection to the next node in the execution chain')
    parser.add_argument('--text', default=None, help='New parameter')
    parser.add_argument('--text_1', default=None, help='New parameter')
    args = parser.parse_args()
    flow_input = {}
    if args.json_input is not None:
        flow_input = json.loads(args.json_input)
    if args.json_input is None:
        if 'Start Flow' not in flow_input:
            flow_input['Start Flow'] = {}
        if args.exec_out is not None:
            flow_input['Start Flow']['exec_out'] = args.exec_out
        if args.text is not None:
            flow_input['Start Flow']['text'] = args.text
        if args.text_1 is not None:
            flow_input['Start Flow']['text_1'] = args.text_1
    workflow_output = execute_workflow(input=flow_input, storage_backend=args.storage_backend)
    print(workflow_output)
