# /// script
# dependencies = []
# 
# [tool.griptape-nodes]
# name = "Nano Banana Pro - Image Collage"
# schema_version = "0.14.0"
# engine_version_created_with = "0.66.0"
# node_libraries_referenced = [["Griptape Nodes Library", "0.52.8"]]
# node_types_used = [["Griptape Nodes Library", "EndFlow"], ["Griptape Nodes Library", "GoogleImageGeneration"], ["Griptape Nodes Library", "LoadImage"], ["Griptape Nodes Library", "Note"], ["Griptape Nodes Library", "StartFlow"]]
# is_griptape_provided = true
# creation_date = 2025-12-18T17:03:44.209505Z
# last_modified_date = "2025-12-18T18:03:29.355598Z"
# workflow_shape = "{\"inputs\":{\"Start Flow\":{\"exec_out\":{\"name\":\"exec_out\",\"tooltip\":\"Connection to the next node in the execution chain\",\"type\":\"parametercontroltype\",\"input_types\":[\"parametercontroltype\"],\"output_type\":\"parametercontroltype\",\"default_value\":null,\"tooltip_as_input\":null,\"tooltip_as_property\":null,\"tooltip_as_output\":null,\"ui_options\":{\"display_name\":\"Flow Out\"},\"settable\":true,\"is_user_defined\":true,\"parent_container_name\":null,\"parent_element_name\":null},\"image_url\":{\"name\":\"image_url\",\"tooltip\":\"Enter text/string for image_url.\",\"type\":\"str\",\"input_types\":[\"str\"],\"output_type\":\"str\",\"default_value\":\"https://images.pdimagearchive.org/collections/posed-portraits-of-19th-century-baseball-stars/4051199982_718521f59f_z.jpg?zz=1?width=438&height=800\",\"tooltip_as_input\":null,\"tooltip_as_property\":null,\"tooltip_as_output\":null,\"ui_options\":{\"is_custom\":true,\"is_user_added\":true},\"settable\":true,\"is_user_defined\":true,\"parent_container_name\":null,\"parent_element_name\":null},\"image\":{\"name\":\"image\",\"tooltip\":\"New parameter\",\"type\":\"ImageUrlArtifact\",\"input_types\":[\"ImageUrlArtifact\",\"ImageArtifact\",\"str\"],\"output_type\":\"ImageUrlArtifact\",\"default_value\":\"\",\"tooltip_as_input\":null,\"tooltip_as_property\":null,\"tooltip_as_output\":null,\"ui_options\":{\"clickable_file_browser\":true,\"expander\":true,\"edit_mask\":true,\"display_name\":\"image\",\"is_custom\":true,\"is_user_added\":true,\"hide\":false},\"settable\":true,\"is_user_defined\":true,\"parent_container_name\":\"\",\"parent_element_name\":null}}},\"outputs\":{\"End Flow\":{\"exec_in\":{\"name\":\"exec_in\",\"tooltip\":\"Control path when the flow completed successfully\",\"type\":\"parametercontroltype\",\"input_types\":[\"parametercontroltype\"],\"output_type\":\"parametercontroltype\",\"default_value\":null,\"tooltip_as_input\":null,\"tooltip_as_property\":null,\"tooltip_as_output\":null,\"ui_options\":{\"display_name\":\"Succeeded\"},\"settable\":true,\"is_user_defined\":true,\"parent_container_name\":null,\"parent_element_name\":null},\"failed\":{\"name\":\"failed\",\"tooltip\":\"Control path when the flow failed\",\"type\":\"parametercontroltype\",\"input_types\":[\"parametercontroltype\"],\"output_type\":\"parametercontroltype\",\"default_value\":null,\"tooltip_as_input\":null,\"tooltip_as_property\":null,\"tooltip_as_output\":null,\"ui_options\":{\"display_name\":\"Failed\"},\"settable\":true,\"is_user_defined\":true,\"parent_container_name\":null,\"parent_element_name\":null},\"was_successful\":{\"name\":\"was_successful\",\"tooltip\":\"Indicates whether it completed without errors.\",\"type\":\"bool\",\"input_types\":[\"bool\"],\"output_type\":\"bool\",\"default_value\":false,\"tooltip_as_input\":null,\"tooltip_as_property\":null,\"tooltip_as_output\":null,\"ui_options\":{},\"settable\":false,\"is_user_defined\":true,\"parent_container_name\":null,\"parent_element_name\":null},\"result_details\":{\"name\":\"result_details\",\"tooltip\":\"Details about the operation result\",\"type\":\"str\",\"input_types\":[\"str\"],\"output_type\":\"str\",\"default_value\":null,\"tooltip_as_input\":null,\"tooltip_as_property\":null,\"tooltip_as_output\":null,\"ui_options\":{\"multiline\":true,\"placeholder_text\":\"Details about the completion or failure will be shown here.\"},\"settable\":false,\"is_user_defined\":true,\"parent_container_name\":null,\"parent_element_name\":null},\"image\":{\"name\":\"image\",\"tooltip\":\"New parameter\",\"type\":\"ImageUrlArtifact\",\"input_types\":[\"ImageUrlArtifact\"],\"output_type\":\"ImageUrlArtifact\",\"default_value\":\"\",\"tooltip_as_input\":null,\"tooltip_as_property\":null,\"tooltip_as_output\":null,\"ui_options\":{\"is_full_width\":true,\"pulse_on_run\":true,\"is_custom\":true,\"is_user_added\":true},\"settable\":true,\"is_user_defined\":true,\"parent_container_name\":\"\",\"parent_element_name\":null}}}}"
# description = "Use Google Gemini Nano Banana Pro's Image to Image workflow to integrate a vintage character into existing modern situations."
# is_template = true
# image = "https://raw.githubusercontent.com/griptape-ai/griptape-nodes/refs/heads/main/libraries/griptape_nodes_library/workflows/templates/thumbnail_nano_banana_pro_-_image_collage.webp"
# 
# ///

import argparse
import asyncio
import json
import pickle
from griptape.artifacts.image_url_artifact import ImageUrlArtifact
from griptape_nodes.bootstrap.workflow_executors.local_workflow_executor import LocalWorkflowExecutor
from griptape_nodes.bootstrap.workflow_executors.workflow_executor import WorkflowExecutor
from griptape_nodes.drivers.storage.storage_backend import StorageBackend
from griptape_nodes.node_library.library_registry import IconVariant, NodeDeprecationMetadata, NodeMetadata
from griptape_nodes.retained_mode.events.connection_events import CreateConnectionRequest
from griptape_nodes.retained_mode.events.flow_events import CreateFlowRequest, GetTopLevelFlowRequest, GetTopLevelFlowResultSuccess
from griptape_nodes.retained_mode.events.library_events import LoadLibrariesRequest
from griptape_nodes.retained_mode.events.node_events import CreateNodeRequest
from griptape_nodes.retained_mode.events.parameter_events import AddParameterToNodeRequest, AlterParameterDetailsRequest, SetParameterValueRequest
from griptape_nodes.retained_mode.griptape_nodes import GriptapeNodes

GriptapeNodes.handle_request(LoadLibrariesRequest())

context_manager = GriptapeNodes.ContextManager()

if not context_manager.has_current_workflow():
    context_manager.push_workflow(workflow_name='Nano Banana Pro - Image Collage')

"""
1. We've collated all of the unique parameter values into a dictionary so that we do not have to duplicate them.
   This minimizes the size of the code, especially for large objects like serialized image files.
2. We're using a prefix so that it's clear which Flow these values are associated with.
3. The values are serialized using pickle, which is a binary format. This makes them harder to read, but makes
   them consistently save and load. It allows us to serialize complex objects like custom classes, which otherwise
   would be difficult to serialize.
"""
top_level_unique_values_dict = {'bb4188c3-cb4d-48a9-a331-24e614685a7f': pickle.loads(b'\x80\x04\x95\x96\x00\x00\x00\x00\x00\x00\x00\x8c\x92https://images.pdimagearchive.org/collections/posed-portraits-of-19th-century-baseball-stars/4051199982_718521f59f_z.jpg?zz=1?width=438&height=800\x94.'), '86d5309a-43ab-417d-800c-9e9a9e000a2c': pickle.loads(b'\x80\x04\x95\x04\x00\x00\x00\x00\x00\x00\x00\x8c\x00\x94.'), '79b56dd7-7f97-42fe-acd3-b0e0a1b3369a': pickle.loads(b'\x80\x04\x88.'), '16ad9d25-a6e2-4d58-b732-1aafa81f108a': pickle.loads(b'\x80\x04\x95R\x00\x00\x00\x00\x00\x00\x00\x8cN[SUCCEEDED] No connection provided for success or failure, assuming successful\x94.'), '1e77dee1-fde9-4443-9f6f-1ff94109f299': pickle.loads(b'\x80\x04\x95\x96\x01\x00\x00\x00\x00\x00\x00\x8c%griptape.artifacts.image_url_artifact\x94\x8c\x10ImageUrlArtifact\x94\x93\x94)\x81\x94}\x94(\x8c\x04type\x94\x8c\x10ImageUrlArtifact\x94\x8c\x0bmodule_name\x94\x8c%griptape.artifacts.image_url_artifact\x94\x8c\x02id\x94\x8c af7187f1f9ef49419b9e4be91764afec\x94\x8c\treference\x94N\x8c\x04meta\x94}\x94\x8c\x04name\x94\x8c\x1fgoogle_image_1766078162_0_0.jpg\x94\x8c\x16encoding_error_handler\x94\x8c\x06strict\x94\x8c\x08encoding\x94\x8c\x05utf-8\x94\x8c\x05value\x94\x8cYhttp://localhost:8124/workspace/static_files/google_image_1766078162_0_0.jpg?t=1766078162\x94ub.'), '0b1901f0-7c93-4eeb-b08e-44d8af0e4a55': pickle.loads(b'\x80\x04\x95r\x01\x00\x00\x00\x00\x00\x00\x8c%griptape.artifacts.image_url_artifact\x94\x8c\x10ImageUrlArtifact\x94\x93\x94)\x81\x94}\x94(\x8c\x04type\x94\x8c\x10ImageUrlArtifact\x94\x8c\x0bmodule_name\x94\x8c%griptape.artifacts.image_url_artifact\x94\x8c\x02id\x94\x8c a4469f447b384d728344c1863ee19a58\x94\x8c\treference\x94N\x8c\x04meta\x94}\x94\x8c\x04name\x94h\n\x8c\x16encoding_error_handler\x94\x8c\x06strict\x94\x8c\x08encoding\x94\x8c\x05utf-8\x94\x8c\x05value\x94\x8cUhttp://localhost:8124/workspace/static_files/4051199982_718521f59f_z.jpg?t=1766028965\x94ub.'), 'c6548deb-55f1-4112-a87b-cfea9d0b9c18': pickle.loads(b'\x80\x04\x95Y\x00\x00\x00\x00\x00\x00\x00\x8cUhttp://localhost:8124/workspace/static_files/4051199982_718521f59f_z.jpg?t=1766028965\x94.'), '654dc593-b4f8-4eb7-9684-7f664011f095': pickle.loads(b'\x80\x04\x95\x08\x00\x00\x00\x00\x00\x00\x00\x8c\x04none\x94.'), 'f8ce8227-a722-48a5-8bf5-7ff4dd8b2f2e': pickle.loads(b'\x80\x04\x89.'), '6375dfc7-9551-4f69-a7f0-2367ccd8227e': pickle.loads(b'\x80\x04\x950\x00\x00\x00\x00\x00\x00\x00\x8c,<Results will appear when the node executes>\x94.'), '13d22155-6940-4585-8c94-77dbddb8b11d': pickle.loads(b'\x80\x04\x95\xae\x02\x00\x00\x00\x00\x00\x00X\xa7\x02\x00\x00# Nano Banana Pro - Image Collage\n\nThis workflow demonstrates the use of Google Gemini [Nano Banana Pro](https://gemini.google/overview/image-generation/) Image to Image workflow to create a photo collage of a vintage character in modern situations.\n\nIt starts with a URL of a person from the [Public Domain Image Archive](https://pdimagearchive.org/galleries/all) - a fantastic resource for inspirational and unique images.\n\nThis URL is passed to the Load Image node, which will then load the image and make it available for Nano Banana Pro.\n\n_Note_: You can provide your own image by simply disconnecting the `image_url` parameter and instead connecting the `image` parameter. \x94.'), '0acbf204-eb20-4594-b984-ac9a16bdb516': pickle.loads(b'\x80\x04\x95\xad\x00\x00\x00\x00\x00\x00\x00\x8c\xa9# Inputs\n\nProvide the url of a person from the [Public Domain Image Archive](https://pdimagearchive.org/galleries/all), or provide your own image and connect it instead.\x94.'), 'a305ee94-1ccf-45c4-8418-1dfaddd2eb9d': pickle.loads(b'\x80\x04\x95F\x00\x00\x00\x00\x00\x00\x00\x8cBCreate a T-pose for this character to provide a base to work from.\x94.'), 'ba092116-9834-43e6-822a-c656f194e9c9': pickle.loads(b'\x80\x04\x95`\x00\x00\x00\x00\x00\x00\x00\x8c\\Use Nano Banana Pro to generate 4 unique images of this character in various urban settings.\x94.'), 'a4911989-e9a2-4faf-9164-08b0fb05f937': pickle.loads(b"\x80\x04\x95'\x00\x00\x00\x00\x00\x00\x00\x8c#Run the workflow to view the result\x94."), 'f9c3c5ae-89a5-4df2-a8f5-eb580b3f97b5': pickle.loads(b'\x80\x04\x95\x15\x00\x00\x00\x00\x00\x00\x00\x8c\x11nano-banana-3-pro\x94.'), '5be1faa9-b4be-4358-b89e-3279c864305b': pickle.loads(b'\x80\x04\x95\xc5\x00\x00\x00\x00\x00\x00\x00\x8c\xc13d high resolution render of this character in a T-pose. vintage textures, detailed clothing. Light background, soft shadows. Maintain the vintage color, texture, and lighting of the character.\x94.'), '7e75b32d-e8ef-4187-a032-28a2b20a0691': pickle.loads(b'\x80\x04\x95u\x01\x00\x00\x00\x00\x00\x00]\x94\x8c%griptape.artifacts.image_url_artifact\x94\x8c\x10ImageUrlArtifact\x94\x93\x94)\x81\x94}\x94(\x8c\x04type\x94\x8c\x10ImageUrlArtifact\x94\x8c\x0bmodule_name\x94\x8c%griptape.artifacts.image_url_artifact\x94\x8c\x02id\x94\x8c a4469f447b384d728344c1863ee19a58\x94\x8c\treference\x94N\x8c\x04meta\x94}\x94\x8c\x04name\x94h\x0b\x8c\x16encoding_error_handler\x94\x8c\x06strict\x94\x8c\x08encoding\x94\x8c\x05utf-8\x94\x8c\x05value\x94\x8cUhttp://localhost:8124/workspace/static_files/4051199982_718521f59f_z.jpg?t=1766028965\x94uba.'), '30bc8bde-6bb6-4981-b3f5-df5ec4ebd446': pickle.loads(b'\x80\x04]\x94.'), '7dc27ed6-9a50-46be-9dda-d3e7b040258a': pickle.loads(b'\x80\x04]\x94.'), 'cb239851-7953-446c-9c52-2c60ea224bc9': pickle.loads(b'\x80\x04\x95\x08\x00\x00\x00\x00\x00\x00\x00\x8c\x0416:9\x94.'), '45e7ba27-4f5f-4e29-afc0-562a6c335cc1': pickle.loads(b'\x80\x04\x95\x06\x00\x00\x00\x00\x00\x00\x00\x8c\x021K\x94.'), '4e5fa702-10bf-4d2b-9527-22ff71d2ff07': pickle.loads(b'\x80\x04\x95\n\x00\x00\x00\x00\x00\x00\x00G?\xf0\x00\x00\x00\x00\x00\x00.'), '5a7bc4ae-03b0-4154-a0c9-74a54ff37ad5': pickle.loads(b'\x80\x04\x954\x02\x00\x00\x00\x00\x00\x00X-\x02\x00\x00A collage of 4 hyper-realistic photos of this vintage character as a tourist in various modern urban settings. Each image highlights a different unique confusing situation for them. \n\nMaintain vintage color grade and texture ONLY for the reference character. All other characters and the environment are modern, unique, and hip with realistic contrast and color tones. Background elements are softly out of focus with subtle noise similar to a real camera sensor.\n\nReduce contrast and saturation on the vintage reference character only.\n\nCanon EOS Rebel T7.\x94.'), '9d670339-5762-4adf-a45a-1f9359d6e781': pickle.loads(b'\x80\x04]\x94.'), '7b7257ba-95b8-48f0-bf5c-c80f95b6315e': pickle.loads(b'\x80\x04]\x94.'), '581c5698-ebbd-4f10-9ddb-ca58741768a8': pickle.loads(b'\x80\x04\x95\x07\x00\x00\x00\x00\x00\x00\x00\x8c\x031:1\x94.')}

'# Create the Flow, then do work within it as context.'

flow0_name = GriptapeNodes.handle_request(CreateFlowRequest(parent_flow_name=None, flow_name='ControlFlow_1', set_as_new_context=False, metadata={})).flow_name

with GriptapeNodes.ContextManager().flow(flow0_name):
    node0_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='StartFlow', specific_library_name='Griptape Nodes Library', node_name='Start Flow', metadata={'position': {'x': -1079.3184088273833, 'y': 166.3418546447166}, 'tempId': 'placing-1765996350930-qa8fpl', 'library_node_metadata': NodeMetadata(category='workflows', description='Define the start of a workflow and pass parameters into the flow', display_name='Start Flow', tags=None, icon=None, color=None, group='create', deprecation=None, is_node_group=None), 'library': 'Griptape Nodes Library', 'node_type': 'StartFlow', 'showaddparameter': True, 'size': {'width': 603, 'height': 433}, 'category': 'workflows'}, resolution='resolved', initial_setup=True)).node_name
    with GriptapeNodes.ContextManager().node(node0_name):
        GriptapeNodes.handle_request(AddParameterToNodeRequest(parameter_name='image_url', default_value='https://images.pdimagearchive.org/collections/posed-portraits-of-19th-century-baseball-stars/4051199982_718521f59f_z.jpg?zz=1?width=438&height=800', tooltip='Enter text/string for image_url.', type='str', input_types=['str'], output_type='str', ui_options={'is_custom': True, 'is_user_added': True}, mode_allowed_input=False, mode_allowed_property=True, mode_allowed_output=True, initial_setup=True))
        GriptapeNodes.handle_request(AddParameterToNodeRequest(parameter_name='image', default_value='', tooltip='New parameter', type='ImageUrlArtifact', input_types=['ImageUrlArtifact', 'ImageArtifact', 'str'], output_type='ImageUrlArtifact', ui_options={'clickable_file_browser': True, 'expander': True, 'edit_mask': True, 'display_name': 'image', 'is_custom': True, 'is_user_added': True, 'hide': False}, mode_allowed_input=True, mode_allowed_property=True, mode_allowed_output=True, parent_container_name='', initial_setup=True))
    node1_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='EndFlow', specific_library_name='Griptape Nodes Library', node_name='End Flow', metadata={'library_node_metadata': NodeMetadata(category='workflows', description='Define the end of a workflow and return parameters from the flow', display_name='End Flow', tags=None, icon=None, color=None, group='create', deprecation=None, is_node_group=None), 'library': 'Griptape Nodes Library', 'node_type': 'EndFlow', 'showaddparameter': True, 'position': {'x': 2005.0163782533587, 'y': 135.93260401626833}, 'size': {'width': 945, 'height': 1244}, 'category': 'workflows'}, initial_setup=True)).node_name
    with GriptapeNodes.ContextManager().node(node1_name):
        GriptapeNodes.handle_request(AddParameterToNodeRequest(parameter_name='image', default_value='', tooltip='New parameter', type='ImageUrlArtifact', input_types=['ImageUrlArtifact'], output_type='ImageUrlArtifact', ui_options={'is_full_width': True, 'pulse_on_run': True, 'is_custom': True, 'is_user_added': True}, mode_allowed_input=True, mode_allowed_property=True, mode_allowed_output=True, parent_container_name='', initial_setup=True))
    node2_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='LoadImage', specific_library_name='Griptape Nodes Library', node_name='Load Image', metadata={'position': {'x': -314.31840882738334, 'y': 166.3418546447166}, 'tempId': 'placing-1766027122379-tyn6li', 'library_node_metadata': NodeMetadata(category='image', description='Loads an image from disk', display_name='Load Image', tags=None, icon='image-up', color=None, group='Input/Output', deprecation=None, is_node_group=None), 'library': 'Griptape Nodes Library', 'node_type': 'LoadImage', 'showaddparameter': False, 'size': {'width': 600, 'height': 540}, 'category': 'image'}, resolution='resolved', initial_setup=True)).node_name
    with GriptapeNodes.ContextManager().node(node2_name):
        GriptapeNodes.handle_request(AlterParameterDetailsRequest(parameter_name='image', settable=False, initial_setup=True))
        GriptapeNodes.handle_request(AlterParameterDetailsRequest(parameter_name='path', settable=False, initial_setup=True))
    node3_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='Note', specific_library_name='Griptape Nodes Library', node_name='Workflow Description', metadata={'position': {'x': -1079.3184088273833, 'y': -522.7913959331105}, 'tempId': 'placing-1766077471138-5mp4lm', 'library_node_metadata': NodeMetadata(category='misc', description='Create a note node to provide helpful context in your workflow', display_name='Note', tags=None, icon='notepad-text', color=None, group='create', deprecation=None, is_node_group=None), 'library': 'Griptape Nodes Library', 'node_type': 'Note', 'showaddparameter': False, 'size': {'width': 749, 'height': 372}, 'category': 'misc'}, initial_setup=True)).node_name
    node4_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='Note', specific_library_name='Griptape Nodes Library', node_name='Step 1', metadata={'position': {'x': -1079.3184088273833, 'y': -108.15814535528341}, 'tempId': 'placing-1766003334530-pnkgh', 'library_node_metadata': NodeMetadata(category='misc', description='Create a note node to provide helpful context in your workflow', display_name='Note', tags=None, icon='notepad-text', color=None, group='create', deprecation=None, is_node_group=None), 'library': 'Griptape Nodes Library', 'node_type': 'Note', 'showaddparameter': False, 'size': {'width': 1365, 'height': 242}, 'category': 'misc'}, resolution='resolved', initial_setup=True)).node_name
    node5_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='Note', specific_library_name='Griptape Nodes Library', node_name='Step 2', metadata={'position': {'x': 505.64340168996534, 'y': -96.10564382947182}, 'tempId': 'placing-1766029587785-4avcqn', 'library_node_metadata': NodeMetadata(category='misc', description='Create a note node to provide helpful context in your workflow', display_name='Note', tags=None, icon='notepad-text', color=None, group='create', deprecation=None, is_node_group=None), 'library': 'Griptape Nodes Library', 'node_type': 'Note', 'showaddparameter': False, 'size': {'width': 600, 'height': 192}, 'category': 'misc'}, resolution='resolved', initial_setup=True)).node_name
    node6_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='Note', specific_library_name='Griptape Nodes Library', node_name='Step 3', metadata={'position': {'x': 1247.684529701857, 'y': -96.10564382947182}, 'tempId': 'placing-1766003370124-fo9hq', 'library_node_metadata': NodeMetadata(category='misc', description='Create a note node to provide helpful context in your workflow', display_name='Note', tags=None, icon='notepad-text', color=None, group='create', deprecation=None, is_node_group=None), 'library': 'Griptape Nodes Library', 'node_type': 'Note', 'showaddparameter': False, 'size': {'width': 600, 'height': 163}, 'category': 'misc'}, resolution='resolved', initial_setup=True)).node_name
    node7_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='Note', specific_library_name='Griptape Nodes Library', node_name='Step 4', metadata={'position': {'x': 2005.0163782533587, 'y': -96.10564382947182}, 'tempId': 'placing-1766003370124-fo9hq', 'library_node_metadata': NodeMetadata(category='misc', description='Create a note node to provide helpful context in your workflow', display_name='Note', tags=None, icon='notepad-text', color=None, group='create', deprecation=None, is_node_group=None), 'library': 'Griptape Nodes Library', 'node_type': 'Note', 'showaddparameter': False, 'size': {'width': 600, 'height': 163}, 'category': 'misc'}, resolution='resolved', initial_setup=True)).node_name
    node8_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='GoogleImageGeneration', specific_library_name='Griptape Nodes Library', node_name='Google Nano Banana Image Generation', metadata={'library_node_metadata': NodeMetadata(category='image', description='Generate images using Google models via Griptape model proxy', display_name='Google Nano Banana Image Generation', tags=None, icon='sparkles', color=None, group='create', deprecation=None, is_node_group=None), 'library': 'Griptape Nodes Library', 'node_type': 'GoogleImageGeneration', 'position': {'x': 505.64340168996534, 'y': 135.93260401626833}, 'size': {'width': 600, 'height': 1056}}, initial_setup=True)).node_name
    with GriptapeNodes.ContextManager().node(node8_name):
        GriptapeNodes.handle_request(AddParameterToNodeRequest(parameter_name='input_images_ParameterListUniqueParamID_c79eb23ab1b84ae9ae6bdc5d609030e7', default_value=[], tooltip='Optional reference images for the generation', type='ImageUrlArtifact', input_types=['ImageUrlArtifact', 'ImageArtifact'], output_type='ImageUrlArtifact', ui_options={'display_name': 'Input Images', 'expander': True}, mode_allowed_input=True, mode_allowed_property=False, mode_allowed_output=False, is_user_defined=True, settable=True, parent_container_name='input_images', initial_setup=True))
    node9_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='GoogleImageGeneration', specific_library_name='Griptape Nodes Library', node_name='Google Nano Banana Image Generation_1', metadata={'library_node_metadata': NodeMetadata(category='image', description='Generate images using Google models via Griptape model proxy', display_name='Google Nano Banana Image Generation', tags=None, icon='sparkles', color=None, group='create', deprecation=None, is_node_group=None), 'library': 'Griptape Nodes Library', 'node_type': 'GoogleImageGeneration', 'position': {'x': 1247.684529701857, 'y': 135.93260401626833}, 'size': {'width': 616, 'height': 1311}}, initial_setup=True)).node_name
    with GriptapeNodes.ContextManager().node(node9_name):
        GriptapeNodes.handle_request(AddParameterToNodeRequest(parameter_name='input_images_ParameterListUniqueParamID_201d9a1a35cb45798efe578b6e60d2da', default_value=[], tooltip='Optional reference images for the generation', type='ImageUrlArtifact', input_types=['ImageUrlArtifact', 'ImageArtifact'], output_type='ImageUrlArtifact', ui_options={'display_name': 'Input Images', 'expander': True}, mode_allowed_input=True, mode_allowed_property=False, mode_allowed_output=False, is_user_defined=True, settable=True, parent_container_name='input_images', initial_setup=True))
    GriptapeNodes.handle_request(CreateConnectionRequest(source_node_name=node0_name, source_parameter_name='image_url', target_node_name=node2_name, target_parameter_name='image', initial_setup=True))
    GriptapeNodes.handle_request(CreateConnectionRequest(source_node_name=node2_name, source_parameter_name='image', target_node_name=node8_name, target_parameter_name='input_images_ParameterListUniqueParamID_c79eb23ab1b84ae9ae6bdc5d609030e7', initial_setup=True))
    GriptapeNodes.handle_request(CreateConnectionRequest(source_node_name=node9_name, source_parameter_name='image', target_node_name=node1_name, target_parameter_name='image', initial_setup=True))
    GriptapeNodes.handle_request(CreateConnectionRequest(source_node_name=node8_name, source_parameter_name='image', target_node_name=node9_name, target_parameter_name='input_images_ParameterListUniqueParamID_201d9a1a35cb45798efe578b6e60d2da', initial_setup=True))
    with GriptapeNodes.ContextManager().node(node0_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='image_url', node_name=node0_name, value=top_level_unique_values_dict['bb4188c3-cb4d-48a9-a331-24e614685a7f'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='image', node_name=node0_name, value=top_level_unique_values_dict['86d5309a-43ab-417d-800c-9e9a9e000a2c'], initial_setup=True, is_output=False))
    with GriptapeNodes.ContextManager().node(node1_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='was_successful', node_name=node1_name, value=top_level_unique_values_dict['79b56dd7-7f97-42fe-acd3-b0e0a1b3369a'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='was_successful', node_name=node1_name, value=top_level_unique_values_dict['79b56dd7-7f97-42fe-acd3-b0e0a1b3369a'], initial_setup=True, is_output=True))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='result_details', node_name=node1_name, value=top_level_unique_values_dict['16ad9d25-a6e2-4d58-b732-1aafa81f108a'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='result_details', node_name=node1_name, value=top_level_unique_values_dict['16ad9d25-a6e2-4d58-b732-1aafa81f108a'], initial_setup=True, is_output=True))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='image', node_name=node1_name, value=top_level_unique_values_dict['1e77dee1-fde9-4443-9f6f-1ff94109f299'], initial_setup=True, is_output=True))
    with GriptapeNodes.ContextManager().node(node2_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='image', node_name=node2_name, value=top_level_unique_values_dict['0b1901f0-7c93-4eeb-b08e-44d8af0e4a55'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='image', node_name=node2_name, value=top_level_unique_values_dict['0b1901f0-7c93-4eeb-b08e-44d8af0e4a55'], initial_setup=True, is_output=True))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='path', node_name=node2_name, value=top_level_unique_values_dict['c6548deb-55f1-4112-a87b-cfea9d0b9c18'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='path', node_name=node2_name, value=top_level_unique_values_dict['c6548deb-55f1-4112-a87b-cfea9d0b9c18'], initial_setup=True, is_output=True))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='mask_channel', node_name=node2_name, value=top_level_unique_values_dict['654dc593-b4f8-4eb7-9684-7f664011f095'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='was_successful', node_name=node2_name, value=top_level_unique_values_dict['f8ce8227-a722-48a5-8bf5-7ff4dd8b2f2e'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='was_successful', node_name=node2_name, value=top_level_unique_values_dict['f8ce8227-a722-48a5-8bf5-7ff4dd8b2f2e'], initial_setup=True, is_output=True))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='result_details', node_name=node2_name, value=top_level_unique_values_dict['6375dfc7-9551-4f69-a7f0-2367ccd8227e'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='result_details', node_name=node2_name, value=top_level_unique_values_dict['6375dfc7-9551-4f69-a7f0-2367ccd8227e'], initial_setup=True, is_output=True))
    with GriptapeNodes.ContextManager().node(node3_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='note', node_name=node3_name, value=top_level_unique_values_dict['13d22155-6940-4585-8c94-77dbddb8b11d'], initial_setup=True, is_output=False))
    with GriptapeNodes.ContextManager().node(node4_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='note', node_name=node4_name, value=top_level_unique_values_dict['0acbf204-eb20-4594-b984-ac9a16bdb516'], initial_setup=True, is_output=False))
    with GriptapeNodes.ContextManager().node(node5_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='note', node_name=node5_name, value=top_level_unique_values_dict['a305ee94-1ccf-45c4-8418-1dfaddd2eb9d'], initial_setup=True, is_output=False))
    with GriptapeNodes.ContextManager().node(node6_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='note', node_name=node6_name, value=top_level_unique_values_dict['ba092116-9834-43e6-822a-c656f194e9c9'], initial_setup=True, is_output=False))
    with GriptapeNodes.ContextManager().node(node7_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='note', node_name=node7_name, value=top_level_unique_values_dict['a4911989-e9a2-4faf-9164-08b0fb05f937'], initial_setup=True, is_output=False))
    with GriptapeNodes.ContextManager().node(node8_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='model', node_name=node8_name, value=top_level_unique_values_dict['f9c3c5ae-89a5-4df2-a8f5-eb580b3f97b5'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='prompt', node_name=node8_name, value=top_level_unique_values_dict['5be1faa9-b4be-4358-b89e-3279c864305b'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='input_images', node_name=node8_name, value=top_level_unique_values_dict['7e75b32d-e8ef-4187-a032-28a2b20a0691'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='input_images_ParameterListUniqueParamID_c79eb23ab1b84ae9ae6bdc5d609030e7', node_name=node8_name, value=top_level_unique_values_dict['0b1901f0-7c93-4eeb-b08e-44d8af0e4a55'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='object_images', node_name=node8_name, value=top_level_unique_values_dict['30bc8bde-6bb6-4981-b3f5-df5ec4ebd446'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='human_images', node_name=node8_name, value=top_level_unique_values_dict['7dc27ed6-9a50-46be-9dda-d3e7b040258a'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='auto_image_resize', node_name=node8_name, value=top_level_unique_values_dict['79b56dd7-7f97-42fe-acd3-b0e0a1b3369a'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='aspect_ratio', node_name=node8_name, value=top_level_unique_values_dict['cb239851-7953-446c-9c52-2c60ea224bc9'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='image_size', node_name=node8_name, value=top_level_unique_values_dict['45e7ba27-4f5f-4e29-afc0-562a6c335cc1'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='temperature', node_name=node8_name, value=top_level_unique_values_dict['4e5fa702-10bf-4d2b-9527-22ff71d2ff07'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='use_google_search', node_name=node8_name, value=top_level_unique_values_dict['f8ce8227-a722-48a5-8bf5-7ff4dd8b2f2e'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='was_successful', node_name=node8_name, value=top_level_unique_values_dict['f8ce8227-a722-48a5-8bf5-7ff4dd8b2f2e'], initial_setup=True, is_output=False))
    with GriptapeNodes.ContextManager().node(node9_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='model', node_name=node9_name, value=top_level_unique_values_dict['f9c3c5ae-89a5-4df2-a8f5-eb580b3f97b5'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='prompt', node_name=node9_name, value=top_level_unique_values_dict['5a7bc4ae-03b0-4154-a0c9-74a54ff37ad5'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='input_images', node_name=node9_name, value=top_level_unique_values_dict['9d670339-5762-4adf-a45a-1f9359d6e781'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='object_images', node_name=node9_name, value=top_level_unique_values_dict['9d670339-5762-4adf-a45a-1f9359d6e781'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='human_images', node_name=node9_name, value=top_level_unique_values_dict['7b7257ba-95b8-48f0-bf5c-c80f95b6315e'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='auto_image_resize', node_name=node9_name, value=top_level_unique_values_dict['79b56dd7-7f97-42fe-acd3-b0e0a1b3369a'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='aspect_ratio', node_name=node9_name, value=top_level_unique_values_dict['581c5698-ebbd-4f10-9ddb-ca58741768a8'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='image_size', node_name=node9_name, value=top_level_unique_values_dict['45e7ba27-4f5f-4e29-afc0-562a6c335cc1'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='temperature', node_name=node9_name, value=top_level_unique_values_dict['4e5fa702-10bf-4d2b-9527-22ff71d2ff07'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='use_google_search', node_name=node9_name, value=top_level_unique_values_dict['f8ce8227-a722-48a5-8bf5-7ff4dd8b2f2e'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='was_successful', node_name=node9_name, value=top_level_unique_values_dict['f8ce8227-a722-48a5-8bf5-7ff4dd8b2f2e'], initial_setup=True, is_output=False))

def _ensure_workflow_context():
    context_manager = GriptapeNodes.ContextManager()
    if not context_manager.has_current_flow():
        top_level_flow_request = GetTopLevelFlowRequest()
        top_level_flow_result = GriptapeNodes.handle_request(top_level_flow_request)
        if isinstance(top_level_flow_result, GetTopLevelFlowResultSuccess) and top_level_flow_result.flow_name is not None:
            flow_manager = GriptapeNodes.FlowManager()
            flow_obj = flow_manager.get_flow_by_name(top_level_flow_result.flow_name)
            context_manager.push_flow(flow_obj)

def execute_workflow(input: dict, storage_backend: str='local', workflow_executor: WorkflowExecutor | None=None, pickle_control_flow_result: bool=False) -> dict | None:
    return asyncio.run(aexecute_workflow(input=input, storage_backend=storage_backend, workflow_executor=workflow_executor, pickle_control_flow_result=pickle_control_flow_result))

async def aexecute_workflow(input: dict, storage_backend: str='local', workflow_executor: WorkflowExecutor | None=None, pickle_control_flow_result: bool=False) -> dict | None:
    _ensure_workflow_context()
    storage_backend_enum = StorageBackend(storage_backend)
    workflow_executor = workflow_executor or LocalWorkflowExecutor(storage_backend=storage_backend_enum)
    async with workflow_executor as executor:
        await executor.arun(flow_input=input, pickle_control_flow_result=pickle_control_flow_result)
    return executor.output

if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    parser.add_argument('--storage-backend', choices=['local', 'gtc'], default='local', help="Storage backend to use: 'local' for local filesystem or 'gtc' for Griptape Cloud")
    parser.add_argument('--json-input', default=None, help='JSON string containing parameter values. Takes precedence over individual parameter arguments if provided.')
    parser.add_argument('--exec_out', default=None, help='Connection to the next node in the execution chain')
    parser.add_argument('--image_url', default=None, help='Enter text/string for image_url.')
    parser.add_argument('--image', default=None, help='New parameter')
    args = parser.parse_args()
    flow_input = {}
    if args.json_input is not None:
        flow_input = json.loads(args.json_input)
    if args.json_input is None:
        if 'Start Flow' not in flow_input:
            flow_input['Start Flow'] = {}
        if args.exec_out is not None:
            flow_input['Start Flow']['exec_out'] = args.exec_out
        if args.image_url is not None:
            flow_input['Start Flow']['image_url'] = args.image_url
        if args.image is not None:
            flow_input['Start Flow']['image'] = args.image
    workflow_output = execute_workflow(input=flow_input, storage_backend=args.storage_backend)
    print(workflow_output)
