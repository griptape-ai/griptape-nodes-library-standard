# /// script
# dependencies = []
# 
# [tool.griptape-nodes]
# name = "Qwen-Image - Band Poster"
# schema_version = "0.14.0"
# engine_version_created_with = "0.66.0"
# node_libraries_referenced = [["Griptape Nodes Library", "0.52.6"]]
# node_types_used = [["Griptape Nodes Library", "Agent"], ["Griptape Nodes Library", "EndFlow"], ["Griptape Nodes Library", "MergeTexts"], ["Griptape Nodes Library", "Note"], ["Griptape Nodes Library", "QwenImageGeneration"], ["Griptape Nodes Library", "Ruleset"], ["Griptape Nodes Library", "StartFlow"]]
# description = "Create a decade-specific band poster using Qwen-Image to generate an image and OpenAI gpt-4.1-mini to help design the prompt."
# is_griptape_provided = true
# is_template = true
# creation_date = 2025-12-18T15:29:28.587729Z
# last_modified_date = "2025-12-18T15:38:42.543642Z"
# workflow_shape = "{\"inputs\":{\"Start Flow\":{\"exec_out\":{\"name\":\"exec_out\",\"tooltip\":\"Connection to the next node in the execution chain\",\"type\":\"parametercontroltype\",\"input_types\":[\"parametercontroltype\"],\"output_type\":\"parametercontroltype\",\"default_value\":null,\"tooltip_as_input\":null,\"tooltip_as_property\":null,\"tooltip_as_output\":null,\"ui_options\":{\"display_name\":\"Flow Out\"},\"settable\":true,\"is_user_defined\":true,\"parent_container_name\":null,\"parent_element_name\":null},\"text\":{\"name\":\"text\",\"tooltip\":\"New parameter\",\"type\":\"str\",\"input_types\":[\"any\"],\"output_type\":\"str\",\"default_value\":\"\",\"tooltip_as_input\":null,\"tooltip_as_property\":null,\"tooltip_as_output\":null,\"ui_options\":{\"multiline\":true,\"placeholder_text\":\"The text content to display\",\"hide_label\":false,\"hide_property\":false,\"is_custom\":true,\"is_user_added\":true,\"hide\":false,\"display_name\":\"subject\"},\"settable\":true,\"is_user_defined\":true,\"parent_container_name\":\"\",\"parent_element_name\":null},\"text_1\":{\"name\":\"text_1\",\"tooltip\":\"New parameter\",\"type\":\"str\",\"input_types\":[\"any\"],\"output_type\":\"str\",\"default_value\":\"\",\"tooltip_as_input\":null,\"tooltip_as_property\":null,\"tooltip_as_output\":null,\"ui_options\":{\"multiline\":true,\"placeholder_text\":\"The text content to display\",\"hide_label\":false,\"hide_property\":false,\"is_custom\":true,\"is_user_added\":true,\"hide\":false,\"display_name\":\"decade\"},\"settable\":true,\"is_user_defined\":true,\"parent_container_name\":\"\",\"parent_element_name\":null}}},\"outputs\":{\"End Flow\":{\"exec_in\":{\"name\":\"exec_in\",\"tooltip\":\"Control path when the flow completed successfully\",\"type\":\"parametercontroltype\",\"input_types\":[\"parametercontroltype\"],\"output_type\":\"parametercontroltype\",\"default_value\":null,\"tooltip_as_input\":null,\"tooltip_as_property\":null,\"tooltip_as_output\":null,\"ui_options\":{\"display_name\":\"Succeeded\"},\"settable\":true,\"is_user_defined\":true,\"parent_container_name\":null,\"parent_element_name\":null},\"failed\":{\"name\":\"failed\",\"tooltip\":\"Control path when the flow failed\",\"type\":\"parametercontroltype\",\"input_types\":[\"parametercontroltype\"],\"output_type\":\"parametercontroltype\",\"default_value\":null,\"tooltip_as_input\":null,\"tooltip_as_property\":null,\"tooltip_as_output\":null,\"ui_options\":{\"display_name\":\"Failed\"},\"settable\":true,\"is_user_defined\":true,\"parent_container_name\":null,\"parent_element_name\":null},\"was_successful\":{\"name\":\"was_successful\",\"tooltip\":\"Indicates whether it completed without errors.\",\"type\":\"bool\",\"input_types\":[\"bool\"],\"output_type\":\"bool\",\"default_value\":false,\"tooltip_as_input\":null,\"tooltip_as_property\":null,\"tooltip_as_output\":null,\"ui_options\":{},\"settable\":false,\"is_user_defined\":true,\"parent_container_name\":null,\"parent_element_name\":null},\"result_details\":{\"name\":\"result_details\",\"tooltip\":\"Details about the operation result\",\"type\":\"str\",\"input_types\":[\"str\"],\"output_type\":\"str\",\"default_value\":null,\"tooltip_as_input\":null,\"tooltip_as_property\":null,\"tooltip_as_output\":null,\"ui_options\":{\"multiline\":true,\"placeholder_text\":\"Details about the completion or failure will be shown here.\"},\"settable\":false,\"is_user_defined\":true,\"parent_container_name\":null,\"parent_element_name\":null},\"image_url\":{\"name\":\"image_url\",\"tooltip\":\"New parameter\",\"type\":\"ImageUrlArtifact\",\"input_types\":[\"ImageUrlArtifact\"],\"output_type\":\"ImageUrlArtifact\",\"default_value\":\"\",\"tooltip_as_input\":null,\"tooltip_as_property\":null,\"tooltip_as_output\":null,\"ui_options\":{\"is_full_width\":true,\"pulse_on_run\":true,\"is_custom\":true,\"is_user_added\":true},\"settable\":true,\"is_user_defined\":true,\"parent_container_name\":\"\",\"parent_element_name\":null}}}}"
# image = "https://raw.githubusercontent.com/griptape-ai/griptape-nodes/refs/heads/main/libraries/griptape_nodes_library/workflows/templates/thumbnail_qwen-image_-_band_poster.webp"
# 
# ///

import argparse
import asyncio
import json
import pickle
from griptape.rules.ruleset import Ruleset
from griptape_nodes.bootstrap.workflow_executors.local_workflow_executor import LocalWorkflowExecutor
from griptape_nodes.bootstrap.workflow_executors.workflow_executor import WorkflowExecutor
from griptape_nodes.drivers.storage.storage_backend import StorageBackend
from griptape_nodes.node_library.library_registry import IconVariant, NodeDeprecationMetadata, NodeMetadata
from griptape_nodes.retained_mode.events.connection_events import CreateConnectionRequest
from griptape_nodes.retained_mode.events.flow_events import CreateFlowRequest, GetTopLevelFlowRequest, GetTopLevelFlowResultSuccess
from griptape_nodes.retained_mode.events.library_events import LoadLibrariesRequest
from griptape_nodes.retained_mode.events.node_events import CreateNodeRequest
from griptape_nodes.retained_mode.events.parameter_events import AddParameterToNodeRequest, AlterParameterDetailsRequest, SetParameterValueRequest
from griptape_nodes.retained_mode.griptape_nodes import GriptapeNodes

GriptapeNodes.handle_request(LoadLibrariesRequest())

context_manager = GriptapeNodes.ContextManager()

if not context_manager.has_current_workflow():
    context_manager.push_workflow(workflow_name='Qwen-Image - Band Poster')

"""
1. We've collated all of the unique parameter values into a dictionary so that we do not have to duplicate them.
   This minimizes the size of the code, especially for large objects like serialized image files.
2. We're using a prefix so that it's clear which Flow these values are associated with.
3. The values are serialized using pickle, which is a binary format. This makes them harder to read, but makes
   them consistently save and load. It allows us to serialize complex objects like custom classes, which otherwise
   would be difficult to serialize.
"""
top_level_unique_values_dict = {'8ef484bc-a910-40ec-a55e-46f68482a672': pickle.loads(b'\x80\x04\x95\x11\x00\x00\x00\x00\x00\x00\x00\x8c\rThe Capybaras\x94.'), 'ba4efda3-109e-42f6-852e-b72f7dceb010': pickle.loads(b'\x80\x04\x95\t\x00\x00\x00\x00\x00\x00\x00\x8c\x051960s\x94.'), 'a7205e3a-d10b-4343-86b9-7f1c9b025370': pickle.loads(b'\x80\x04\x95G\x15\x00\x00\x00\x00\x00\x00}\x94(\x8c\x04type\x94\x8c\x12GriptapeNodesAgent\x94\x8c\x08rulesets\x94]\x94}\x94(h\x01\x8c\x07Ruleset\x94\x8c\x02id\x94\x8c 90289c39945741e7856e0f91ccb6b716\x94\x8c\x04name\x94\x8c\x15Qwen  Prompting Guide\x94\x8c\x04meta\x94}\x94\x8c\x05rules\x94]\x94(}\x94(h\x01\x8c\x04Rule\x94\x8c\x05value\x94\x8c\x1f**Rules for Crafting Prompts:**\x94u}\x94(h\x01h\x10h\x11\x8c\xc9Use the following prompt formula when generating prompts:\nPrompt = Subject (Subject Description) + Scene (Scene Description) + Style (Define Style) + Lens Language + Atmosphere Words + Detail Modifiers\x94u}\x94(h\x01h\x10h\x11\x8c\xb4**Subject Description:**\nClearly describe the subject in the image, including its characteristics, actions, etc. For example, "a cute 10-year-old Chinese girl wearing red clothes".\x94u}\x94(h\x01h\x10h\x11\x8c\xb2**Scene Description:**\nScene description is a detailed description of the environmental characteristics of the subject, which can be listed through adjectives or short sentences.\x94u}\x94(h\x01h\x10h\x11\x8c\xcf**Define Style:**\nDefine style is to clearly describe the specific artistic style, expression technique, or visual characteristics that the image should have. For example, "watercolor style", "comic style". \x94u}\x94(h\x01h\x10h\x11\x8cGCommon stylization details can be found in the prompt dictionary below.\x94u}\x94(h\x01h\x10h\x11\x8c\x12**Lens Language:**\x94u}\x94(h\x01h\x10h\x11\x8cmLens language includes framing, perspective, etc. Common lens language can be found in the prompt dictionary.\x94u}\x94(h\x01h\x10h\x11\x8c\xc5**Atmosphere Words:**\nAtmosphere words are descriptions of the expected picture atmosphere, such as "dreamy", "lonely", "magnificent". Common atmosphere words can be found in the prompt dictionary.\x94u}\x94(h\x01h\x10h\x11X\t\x01\x00\x00**Detail Modifiers:**\nDetail modifiers are further refinement and optimization of the picture to enhance the image\'s detail expressiveness, richness, and beauty. For example, "light source position", "prop matching", "environmental details", "high resolution", etc.\x94u}\x94(h\x01h\x10h\x11\x8c\xaf**Advanced Techniques**\n1. Style Mixing\n"Portrait of a cyberpunk samurai, blend of traditional Japanese art \nand neon futurism, style of Katsushika Hokusai meets Blade Runner"\x94u}\x94(h\x01h\x10h\x11\x8c\x8e2. Weighted Elements\n"Beautiful landscape with (mountains:1.5), (lake:1.2), (forest:0.8),\ngolden hour lighting, ultra detailed, 8k resolution"\x94u}\x94(h\x01h\x10h\x11\x8c|3. Negative Prompts\nPrompt: "Elegant minimalist logo design"\nNegative: "complex, busy, cluttered, photorealistic, 3D render"\x94u}\x94(h\x01h\x10h\x11X\x87\x01\x00\x00# Prompt Dictionary\n## Framing: \nFraming refers to the difference in the range size of the subject presented in the image due to the different distances between the camera and the subject being photographed. It can generally be divided into long shot, full shot, medium shot, close-up, extreme close-up, etc. Here are some framing examples:\nExtreme Close-up, Close-up, Medium Shot, Long Shot\x94u}\x94(h\x01h\x10h\x11\x8c\xb4## Perspective:\nLens perspective, that is, the perspective chosen when the camera shoots the picture. Here are some perspective examples:\nEye Level, High Angle, Low Angle, Aerial, \x94u}\x94(h\x01h\x10h\x11\x8c\xe9## Lens Type:\nLens type refers to the different types of camera lenses divided according to different focal lengths, functions, application scenarios, etc. Here are some lens type examples:\nMacro, Ultra Wide Angle, Telephoto, Fisheye\x94u}\x94(h\x01h\x10h\x11\x8c\xf7## Style\nDefine style is to clearly describe the specific artistic style, expression technique, or visual characteristics that the image should have. Here are some style type examples:\n3D Cartoon, Post-apocalyptic, pointillism, surreal, watercolor\x94u}\x94(h\x01h\x10h\x11\x8c\xcf## Lighting\nDifferent types of lighting can create various atmospheres and effects, meeting different creative needs. Here are some lighting type examples:\nNatural light, backlight, neon light, ambient light\x94u}\x94(h\x01h\x10h\x11\x8c9Important: Add specific details to make the prompt unique\x94ueuah\r]\x94h\x07\x8c dd0c626a18fd4e09b1b05f43c00b7f40\x94\x8c\x13conversation_memory\x94}\x94(h\x01\x8c\x12ConversationMemory\x94\x8c\x04runs\x94]\x94}\x94(h\x01\x8c\x03Run\x94h\x07\x8c 3763d31a3f9e44e6b9aef86895f0d3fa\x94h\x0bN\x8c\x05input\x94}\x94(h\x01\x8c\x0cTextArtifact\x94h\x07\x8c 33386e7388a74f498c0482a9d6ac08f7\x94\x8c\treference\x94Nh\x0b}\x94h\thDh\x11X\x00\x01\x00\x00Create a band poster from specified decade of the following band. Include dates and some creative support bands. \n\nMake the image and article titles authentic to the time period.\n\nOutput only the Image Generation Prompt\nSubject:\nThe Capybaras\nDecade:\n1960s\x94u\x8c\x06output\x94}\x94(h\x01hCh\x07\x8c 2fb0d0a3cfa94b6db969eed63a46f519\x94hENh\x0b}\x94\x8c\x0fis_react_prompt\x94\x89sh\thJh\x11X\x11\x03\x00\x00The Capybaras (a lively 1960s British rock band with mod fashion and energetic stage presence) + Scene (a vibrant 1960s concert poster featuring psychedelic patterns, bold colorful swirls, and vintage typography, with The Capybaras front and center playing guitars and drums, surrounded by creative support bands "The Electric Peacocks" and "The Velvet Tides", dates listed as "Summer Tour 1967: July 10 - August 25") + Style (psychedelic 1960s poster art style with hand-drawn illustrations and groovy fonts) + Lens Language (medium shot framing of band members integrated into poster design) + Atmosphere Words (energetic, vibrant, retro, psychedelic, lively) + Detail Modifiers (bold contrasting colors, vintage paper texture, intricate floral and paisley patterns, high resolution)\x94uuah\x0b}\x94\x8c\x08max_runs\x94Nu\x8c\x1cconversation_memory_strategy\x94\x8c\rper_structure\x94\x8c\x05tasks\x94]\x94}\x94(h\x01\x8c\nPromptTask\x94h\x03]\x94h\r]\x94h\x07\x8c 905913cdc8864803a603eff9ea09034b\x94\x8c\x05state\x94\x8c\x0eState.FINISHED\x94\x8c\nparent_ids\x94]\x94\x8c\tchild_ids\x94]\x94\x8c\x17max_meta_memory_entries\x94K\x14\x8c\x07context\x94}\x94\x8c\rprompt_driver\x94}\x94(h\x01\x8c\x19GriptapeCloudPromptDriver\x94\x8c\x0btemperature\x94G?\xb9\x99\x99\x99\x99\x99\x9a\x8c\nmax_tokens\x94N\x8c\x06stream\x94\x88\x8c\x0cextra_params\x94}\x94\x8c\x05model\x94\x8c\x0cgpt-4.1-mini\x94\x8c\x1astructured_output_strategy\x94\x8c\x06native\x94u\x8c\x05tools\x94]\x94\x8c\x0cmax_subtasks\x94K\x14uau.'), 'f76f1e2f-d686-4e9a-835a-39205cc86e2d': pickle.loads(b'\x80\x04\x95\x10\x00\x00\x00\x00\x00\x00\x00\x8c\x0cgpt-4.1-mini\x94.'), '1d0b600f-32ee-4e4a-bf32-f7a6cc3c5c1f': pickle.loads(b'\x80\x04\x95\xdf\x00\x00\x00\x00\x00\x00\x00\x8c\xdbCreate a band poster from specified decade of the following band. Include dates and some creative support bands. \n\nMake the image and article titles authentic to the time period.\n\nOutput only the Image Generation Prompt\x94.'), 'b6961639-71ba-4805-b295-37051bc697f4': pickle.loads(b'\x80\x04\x95(\x00\x00\x00\x00\x00\x00\x00\x8c$Subject:\nThe Capybaras\nDecade:\n1960s\x94.'), '2e3340f7-514b-470e-90ed-d7ab33bb5a37': pickle.loads(b'\x80\x04]\x94.'), 'b503e0df-f92f-4d87-a32b-42ab63522178': pickle.loads(b'\x80\x04\x95`\x10\x00\x00\x00\x00\x00\x00]\x94\x8c\x16griptape.rules.ruleset\x94\x8c\x07Ruleset\x94\x93\x94)\x81\x94}\x94(\x8c\x04type\x94\x8c\x07Ruleset\x94\x8c\x0bmodule_name\x94\x8c\x16griptape.rules.ruleset\x94\x8c\x02id\x94\x8c 90289c39945741e7856e0f91ccb6b716\x94\x8c\x04name\x94\x8c\x15Qwen  Prompting Guide\x94\x8c\x0eruleset_driver\x94\x8c-griptape.drivers.ruleset.local_ruleset_driver\x94\x8c\x12LocalRulesetDriver\x94\x93\x94)\x81\x94}\x94(h\x06\x8c\x12LocalRulesetDriver\x94h\x08\x8c-griptape.drivers.ruleset.local_ruleset_driver\x94\x8c\x0fraise_not_found\x94\x88\x8c\x0bpersist_dir\x94Nub\x8c\x04meta\x94}\x94\x8c\x05rules\x94]\x94(\x8c\x13griptape.rules.rule\x94\x8c\x04Rule\x94\x93\x94)\x81\x94}\x94(h\x06\x8c\x04Rule\x94h\x08\x8c\x13griptape.rules.rule\x94h\x18}\x94\x8c\x05value\x94\x8c\x1f**Rules for Crafting Prompts:**\x94ubh\x1e)\x81\x94}\x94(h\x06h!h\x08h"h\x18}\x94h$\x8c\xc9Use the following prompt formula when generating prompts:\nPrompt = Subject (Subject Description) + Scene (Scene Description) + Style (Define Style) + Lens Language + Atmosphere Words + Detail Modifiers\x94ubh\x1e)\x81\x94}\x94(h\x06h!h\x08h"h\x18}\x94h$\x8c\xb4**Subject Description:**\nClearly describe the subject in the image, including its characteristics, actions, etc. For example, "a cute 10-year-old Chinese girl wearing red clothes".\x94ubh\x1e)\x81\x94}\x94(h\x06h!h\x08h"h\x18}\x94h$\x8c\xb2**Scene Description:**\nScene description is a detailed description of the environmental characteristics of the subject, which can be listed through adjectives or short sentences.\x94ubh\x1e)\x81\x94}\x94(h\x06h!h\x08h"h\x18}\x94h$\x8c\xcf**Define Style:**\nDefine style is to clearly describe the specific artistic style, expression technique, or visual characteristics that the image should have. For example, "watercolor style", "comic style". \x94ubh\x1e)\x81\x94}\x94(h\x06h!h\x08h"h\x18}\x94h$\x8cGCommon stylization details can be found in the prompt dictionary below.\x94ubh\x1e)\x81\x94}\x94(h\x06h!h\x08h"h\x18}\x94h$\x8c\x12**Lens Language:**\x94ubh\x1e)\x81\x94}\x94(h\x06h!h\x08h"h\x18}\x94h$\x8cmLens language includes framing, perspective, etc. Common lens language can be found in the prompt dictionary.\x94ubh\x1e)\x81\x94}\x94(h\x06h!h\x08h"h\x18}\x94h$\x8c\xc5**Atmosphere Words:**\nAtmosphere words are descriptions of the expected picture atmosphere, such as "dreamy", "lonely", "magnificent". Common atmosphere words can be found in the prompt dictionary.\x94ubh\x1e)\x81\x94}\x94(h\x06h!h\x08h"h\x18}\x94h$X\t\x01\x00\x00**Detail Modifiers:**\nDetail modifiers are further refinement and optimization of the picture to enhance the image\'s detail expressiveness, richness, and beauty. For example, "light source position", "prop matching", "environmental details", "high resolution", etc.\x94ubh\x1e)\x81\x94}\x94(h\x06h!h\x08h"h\x18}\x94h$\x8c\xaf**Advanced Techniques**\n1. Style Mixing\n"Portrait of a cyberpunk samurai, blend of traditional Japanese art \nand neon futurism, style of Katsushika Hokusai meets Blade Runner"\x94ubh\x1e)\x81\x94}\x94(h\x06h!h\x08h"h\x18}\x94h$\x8c\x8e2. Weighted Elements\n"Beautiful landscape with (mountains:1.5), (lake:1.2), (forest:0.8),\ngolden hour lighting, ultra detailed, 8k resolution"\x94ubh\x1e)\x81\x94}\x94(h\x06h!h\x08h"h\x18}\x94h$\x8c|3. Negative Prompts\nPrompt: "Elegant minimalist logo design"\nNegative: "complex, busy, cluttered, photorealistic, 3D render"\x94ubh\x1e)\x81\x94}\x94(h\x06h!h\x08h"h\x18}\x94h$X\x87\x01\x00\x00# Prompt Dictionary\n## Framing: \nFraming refers to the difference in the range size of the subject presented in the image due to the different distances between the camera and the subject being photographed. It can generally be divided into long shot, full shot, medium shot, close-up, extreme close-up, etc. Here are some framing examples:\nExtreme Close-up, Close-up, Medium Shot, Long Shot\x94ubh\x1e)\x81\x94}\x94(h\x06h!h\x08h"h\x18}\x94h$\x8c\xb4## Perspective:\nLens perspective, that is, the perspective chosen when the camera shoots the picture. Here are some perspective examples:\nEye Level, High Angle, Low Angle, Aerial, \x94ubh\x1e)\x81\x94}\x94(h\x06h!h\x08h"h\x18}\x94h$\x8c\xe9## Lens Type:\nLens type refers to the different types of camera lenses divided according to different focal lengths, functions, application scenarios, etc. Here are some lens type examples:\nMacro, Ultra Wide Angle, Telephoto, Fisheye\x94ubh\x1e)\x81\x94}\x94(h\x06h!h\x08h"h\x18}\x94h$\x8c\xf7## Style\nDefine style is to clearly describe the specific artistic style, expression technique, or visual characteristics that the image should have. Here are some style type examples:\n3D Cartoon, Post-apocalyptic, pointillism, surreal, watercolor\x94ubh\x1e)\x81\x94}\x94(h\x06h!h\x08h"h\x18}\x94h$\x8c\xcf## Lighting\nDifferent types of lighting can create various atmospheres and effects, meeting different creative needs. Here are some lighting type examples:\nNatural light, backlight, neon light, ambient light\x94ubh\x1e)\x81\x94}\x94(h\x06h!h\x08h"h\x18}\x94h$\x8c9Important: Add specific details to make the prompt unique\x94ubeuba.'), 'd3b774c4-8264-4ffc-9abb-fb25fe7dad83': pickle.loads(b'\x80\x04\x95]\x10\x00\x00\x00\x00\x00\x00\x8c\x16griptape.rules.ruleset\x94\x8c\x07Ruleset\x94\x93\x94)\x81\x94}\x94(\x8c\x04type\x94\x8c\x07Ruleset\x94\x8c\x0bmodule_name\x94\x8c\x16griptape.rules.ruleset\x94\x8c\x02id\x94\x8c 90289c39945741e7856e0f91ccb6b716\x94\x8c\x04name\x94\x8c\x15Qwen  Prompting Guide\x94\x8c\x0eruleset_driver\x94\x8c-griptape.drivers.ruleset.local_ruleset_driver\x94\x8c\x12LocalRulesetDriver\x94\x93\x94)\x81\x94}\x94(h\x05\x8c\x12LocalRulesetDriver\x94h\x07\x8c-griptape.drivers.ruleset.local_ruleset_driver\x94\x8c\x0fraise_not_found\x94\x88\x8c\x0bpersist_dir\x94Nub\x8c\x04meta\x94}\x94\x8c\x05rules\x94]\x94(\x8c\x13griptape.rules.rule\x94\x8c\x04Rule\x94\x93\x94)\x81\x94}\x94(h\x05\x8c\x04Rule\x94h\x07\x8c\x13griptape.rules.rule\x94h\x17}\x94\x8c\x05value\x94\x8c\x1f**Rules for Crafting Prompts:**\x94ubh\x1d)\x81\x94}\x94(h\x05h h\x07h!h\x17}\x94h#\x8c\xc9Use the following prompt formula when generating prompts:\nPrompt = Subject (Subject Description) + Scene (Scene Description) + Style (Define Style) + Lens Language + Atmosphere Words + Detail Modifiers\x94ubh\x1d)\x81\x94}\x94(h\x05h h\x07h!h\x17}\x94h#\x8c\xb4**Subject Description:**\nClearly describe the subject in the image, including its characteristics, actions, etc. For example, "a cute 10-year-old Chinese girl wearing red clothes".\x94ubh\x1d)\x81\x94}\x94(h\x05h h\x07h!h\x17}\x94h#\x8c\xb2**Scene Description:**\nScene description is a detailed description of the environmental characteristics of the subject, which can be listed through adjectives or short sentences.\x94ubh\x1d)\x81\x94}\x94(h\x05h h\x07h!h\x17}\x94h#\x8c\xcf**Define Style:**\nDefine style is to clearly describe the specific artistic style, expression technique, or visual characteristics that the image should have. For example, "watercolor style", "comic style". \x94ubh\x1d)\x81\x94}\x94(h\x05h h\x07h!h\x17}\x94h#\x8cGCommon stylization details can be found in the prompt dictionary below.\x94ubh\x1d)\x81\x94}\x94(h\x05h h\x07h!h\x17}\x94h#\x8c\x12**Lens Language:**\x94ubh\x1d)\x81\x94}\x94(h\x05h h\x07h!h\x17}\x94h#\x8cmLens language includes framing, perspective, etc. Common lens language can be found in the prompt dictionary.\x94ubh\x1d)\x81\x94}\x94(h\x05h h\x07h!h\x17}\x94h#\x8c\xc5**Atmosphere Words:**\nAtmosphere words are descriptions of the expected picture atmosphere, such as "dreamy", "lonely", "magnificent". Common atmosphere words can be found in the prompt dictionary.\x94ubh\x1d)\x81\x94}\x94(h\x05h h\x07h!h\x17}\x94h#X\t\x01\x00\x00**Detail Modifiers:**\nDetail modifiers are further refinement and optimization of the picture to enhance the image\'s detail expressiveness, richness, and beauty. For example, "light source position", "prop matching", "environmental details", "high resolution", etc.\x94ubh\x1d)\x81\x94}\x94(h\x05h h\x07h!h\x17}\x94h#\x8c\xaf**Advanced Techniques**\n1. Style Mixing\n"Portrait of a cyberpunk samurai, blend of traditional Japanese art \nand neon futurism, style of Katsushika Hokusai meets Blade Runner"\x94ubh\x1d)\x81\x94}\x94(h\x05h h\x07h!h\x17}\x94h#\x8c\x8e2. Weighted Elements\n"Beautiful landscape with (mountains:1.5), (lake:1.2), (forest:0.8),\ngolden hour lighting, ultra detailed, 8k resolution"\x94ubh\x1d)\x81\x94}\x94(h\x05h h\x07h!h\x17}\x94h#\x8c|3. Negative Prompts\nPrompt: "Elegant minimalist logo design"\nNegative: "complex, busy, cluttered, photorealistic, 3D render"\x94ubh\x1d)\x81\x94}\x94(h\x05h h\x07h!h\x17}\x94h#X\x87\x01\x00\x00# Prompt Dictionary\n## Framing: \nFraming refers to the difference in the range size of the subject presented in the image due to the different distances between the camera and the subject being photographed. It can generally be divided into long shot, full shot, medium shot, close-up, extreme close-up, etc. Here are some framing examples:\nExtreme Close-up, Close-up, Medium Shot, Long Shot\x94ubh\x1d)\x81\x94}\x94(h\x05h h\x07h!h\x17}\x94h#\x8c\xb4## Perspective:\nLens perspective, that is, the perspective chosen when the camera shoots the picture. Here are some perspective examples:\nEye Level, High Angle, Low Angle, Aerial, \x94ubh\x1d)\x81\x94}\x94(h\x05h h\x07h!h\x17}\x94h#\x8c\xe9## Lens Type:\nLens type refers to the different types of camera lenses divided according to different focal lengths, functions, application scenarios, etc. Here are some lens type examples:\nMacro, Ultra Wide Angle, Telephoto, Fisheye\x94ubh\x1d)\x81\x94}\x94(h\x05h h\x07h!h\x17}\x94h#\x8c\xf7## Style\nDefine style is to clearly describe the specific artistic style, expression technique, or visual characteristics that the image should have. Here are some style type examples:\n3D Cartoon, Post-apocalyptic, pointillism, surreal, watercolor\x94ubh\x1d)\x81\x94}\x94(h\x05h h\x07h!h\x17}\x94h#\x8c\xcf## Lighting\nDifferent types of lighting can create various atmospheres and effects, meeting different creative needs. Here are some lighting type examples:\nNatural light, backlight, neon light, ambient light\x94ubh\x1d)\x81\x94}\x94(h\x05h h\x07h!h\x17}\x94h#\x8c9Important: Add specific details to make the prompt unique\x94ubeub.'), 'a4fe1814-6527-4049-bc7d-8acdbbb46b79': pickle.loads(b'\x80\x04\x95\x04\x00\x00\x00\x00\x00\x00\x00\x8c\x00\x94.'), '81333882-790a-4fbc-8f23-fe49a3f3da69': pickle.loads(b'\x80\x04\x95\x18\x03\x00\x00\x00\x00\x00\x00X\x11\x03\x00\x00The Capybaras (a lively 1960s British rock band with mod fashion and energetic stage presence) + Scene (a vibrant 1960s concert poster featuring psychedelic patterns, bold colorful swirls, and vintage typography, with The Capybaras front and center playing guitars and drums, surrounded by creative support bands "The Electric Peacocks" and "The Velvet Tides", dates listed as "Summer Tour 1967: July 10 - August 25") + Style (psychedelic 1960s poster art style with hand-drawn illustrations and groovy fonts) + Lens Language (medium shot framing of band members integrated into poster design) + Atmosphere Words (energetic, vibrant, retro, psychedelic, lively) + Detail Modifiers (bold contrasting colors, vintage paper texture, intricate floral and paisley patterns, high resolution)\x94.'), '1547bac3-4fd7-4d6a-9d64-3b41486a1770': pickle.loads(b'\x80\x04\x89.'), 'ccc66f39-2bcb-408d-9faf-c8e94defb1fd': pickle.loads(b'\x80\x04\x95N\x00\x00\x00\x00\x00\x00\x00\x8cJ[Processing..]\n[Started processing agent..]\n\n[Finished processing agent.]\n\x94.'), 'e702e73f-0405-415e-bd36-7770d1736c02': pickle.loads(b'\x80\x04\x95\x1e\x00\x00\x00\x00\x00\x00\x00\x8c\x1aQwen Image Prompting Guide\x94.'), 'e0311f55-6439-46ba-8ca0-00eac2c8f33c': pickle.loads(b'\x80\x04\x95\xb8\x0c\x00\x00\x00\x00\x00\x00X\xb1\x0c\x00\x00**Rules for Crafting Prompts:**\n\nUse the following prompt formula when generating prompts:\nPrompt = Subject (Subject Description) + Scene (Scene Description) + Style (Define Style) + Lens Language + Atmosphere Words + Detail Modifiers\n\n**Subject Description:**\nClearly describe the subject in the image, including its characteristics, actions, etc. For example, "a cute 10-year-old Chinese girl wearing red clothes".\n\n**Scene Description:**\nScene description is a detailed description of the environmental characteristics of the subject, which can be listed through adjectives or short sentences.\n\n**Define Style:**\nDefine style is to clearly describe the specific artistic style, expression technique, or visual characteristics that the image should have. For example, "watercolor style", "comic style". \n\nCommon stylization details can be found in the prompt dictionary below.\n\n**Lens Language:**\n\nLens language includes framing, perspective, etc. Common lens language can be found in the prompt dictionary.\n\n**Atmosphere Words:**\nAtmosphere words are descriptions of the expected picture atmosphere, such as "dreamy", "lonely", "magnificent". Common atmosphere words can be found in the prompt dictionary.\n\n**Detail Modifiers:**\nDetail modifiers are further refinement and optimization of the picture to enhance the image\'s detail expressiveness, richness, and beauty. For example, "light source position", "prop matching", "environmental details", "high resolution", etc.\n\n**Advanced Techniques**\n1. Style Mixing\n"Portrait of a cyberpunk samurai, blend of traditional Japanese art \nand neon futurism, style of Katsushika Hokusai meets Blade Runner"\n\n2. Weighted Elements\n"Beautiful landscape with (mountains:1.5), (lake:1.2), (forest:0.8),\ngolden hour lighting, ultra detailed, 8k resolution"\n\n3. Negative Prompts\nPrompt: "Elegant minimalist logo design"\nNegative: "complex, busy, cluttered, photorealistic, 3D render"\n\n# Prompt Dictionary\n## Framing: \nFraming refers to the difference in the range size of the subject presented in the image due to the different distances between the camera and the subject being photographed. It can generally be divided into long shot, full shot, medium shot, close-up, extreme close-up, etc. Here are some framing examples:\nExtreme Close-up, Close-up, Medium Shot, Long Shot\n\n## Perspective:\nLens perspective, that is, the perspective chosen when the camera shoots the picture. Here are some perspective examples:\nEye Level, High Angle, Low Angle, Aerial, \n\n## Lens Type:\nLens type refers to the different types of camera lenses divided according to different focal lengths, functions, application scenarios, etc. Here are some lens type examples:\nMacro, Ultra Wide Angle, Telephoto, Fisheye\n\n## Style\nDefine style is to clearly describe the specific artistic style, expression technique, or visual characteristics that the image should have. Here are some style type examples:\n3D Cartoon, Post-apocalyptic, pointillism, surreal, watercolor\n\n## Lighting\nDifferent types of lighting can create various atmospheres and effects, meeting different creative needs. Here are some lighting type examples:\nNatural light, backlight, neon light, ambient light\n\nImportant: Add specific details to make the prompt unique\x94.'), 'f28322c8-a5e6-4232-be4c-e84f31fc03d4': pickle.loads(b'\x80\x04\x95\x0c\x00\x00\x00\x00\x00\x00\x00\x8c\x08Subject:\x94.'), 'cb0cea0a-2d3f-4aa1-9853-501ff9bfe450': pickle.loads(b'\x80\x04\x95\x0b\x00\x00\x00\x00\x00\x00\x00\x8c\x07Decade:\x94.'), 'd23d0b4f-f4c0-4cba-a099-850c62f8f158': pickle.loads(b'\x80\x04\x95\x06\x00\x00\x00\x00\x00\x00\x00\x8c\x02\\n\x94.'), 'f8c5865a-eeb8-460e-87b5-80408a287a38': pickle.loads(b'\x80\x04\x95I\x00\x00\x00\x00\x00\x00\x00\x8cE# Inputs\n\nProvide a *subject* and a *decade* to create a band poster.\x94.'), '6d47470d-e9d4-4d61-984e-ddd105d555cd': pickle.loads(b'\x80\x04\x95D\x00\x00\x00\x00\x00\x00\x00\x8c@This node merges text into a single message to send to an agent.\x94.'), 'a343ac05-4f5d-41fe-94d7-33a306b7eb0d': pickle.loads(b'\x80\x04\x95\xb0\x00\x00\x00\x00\x00\x00\x00\x8c\xac# Agent Behavior\n\nThese rules are adapted from the [Qwen Prompting Guide](https://www.qwenimagen.com/prompt-guide) and are given to the agent to help guide their responses.\x94.'), '40135bab-8eb7-4105-9fc5-d682eca19ef4': pickle.loads(b'\x80\x04\x95\x95\x00\x00\x00\x00\x00\x00\x00\x8c\x91Using Agents to create image generation prompts helps ensure consistency in the prompt, and allows you to be a bit more free with how you prompt.\x94.'), 'db8799fa-2063-4e99-9562-a712d8ff46ab': pickle.loads(b'\x80\x04\x95!\x00\x00\x00\x00\x00\x00\x00\x8c\x1dGenerate the Image using Qwen\x94.'), 'd89fa857-8653-488a-96b5-d87dcab08908': pickle.loads(b'\x80\x04\x959\x00\x00\x00\x00\x00\x00\x00\x8c5# End Flow\n\nThe flow will return the resulting image.\x94.'), '400df2bb-997e-490b-8c33-fc5db425b73f': pickle.loads(b'\x80\x04\x95\x0e\x00\x00\x00\x00\x00\x00\x00\x8c\nqwen-image\x94.'), '189cb527-1ad4-4467-ae4a-defe3514b143': pickle.loads(b'\x80\x04\x95\r\x00\x00\x00\x00\x00\x00\x00\x8c\t1328*1328\x94.'), '99b85ff0-451f-46bb-8e76-73311ac095d7': pickle.loads(b'\x80\x04K*.'), '043f4322-160e-4d09-9693-7086479a65a9': pickle.loads(b'\x80\x04\x95\xf9\x01\x00\x00\x00\x00\x00\x00X\xf2\x01\x00\x00# Qwen-Image - Band Poster\n\nthis workflow demonstrates the use of the image generation model [Qwen-Image](https://www.qwenimagen.com/) to create a mythical band poster based on a **band_name** and a **decade**.\n\nIt uses an agent with [OpenAI gpt-4.1-mini](https://platform.openai.com/docs/models/gpt-4.1-mini) to design an image generation prompt using some behavioal rules to ensure quality responses.\n\nModify the incoming values in the **Start Flow** node and run the workflow to see the results.\x94.')}

'# Create the Flow, then do work within it as context.'

flow0_name = GriptapeNodes.handle_request(CreateFlowRequest(parent_flow_name=None, flow_name='ControlFlow_1', set_as_new_context=False, metadata={})).flow_name

with GriptapeNodes.ContextManager().flow(flow0_name):
    node0_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='StartFlow', specific_library_name='Griptape Nodes Library', node_name='Start Flow', metadata={'position': {'x': -303.0843370080777, 'y': 296.93529465485886}, 'tempId': 'placing-1765996350930-qa8fpl', 'library_node_metadata': NodeMetadata(category='workflows', description='Define the start of a workflow and pass parameters into the flow', display_name='Start Flow', tags=None, icon=None, color=None, group='create', deprecation=None, is_node_group=None), 'library': 'Griptape Nodes Library', 'node_type': 'StartFlow', 'showaddparameter': True, 'size': {'width': 600, 'height': 347}, 'category': 'workflows'}, resolution='resolved', initial_setup=True)).node_name
    with GriptapeNodes.ContextManager().node(node0_name):
        GriptapeNodes.handle_request(AddParameterToNodeRequest(parameter_name='text', default_value='', tooltip='New parameter', type='str', input_types=['any'], output_type='str', ui_options={'multiline': True, 'placeholder_text': 'The text content to display', 'hide_label': False, 'hide_property': False, 'is_custom': True, 'is_user_added': True, 'hide': False, 'display_name': 'subject'}, mode_allowed_input=True, mode_allowed_property=True, mode_allowed_output=True, parent_container_name='', initial_setup=True))
        GriptapeNodes.handle_request(AddParameterToNodeRequest(parameter_name='text_1', default_value='', tooltip='New parameter', type='str', input_types=['any'], output_type='str', ui_options={'multiline': True, 'placeholder_text': 'The text content to display', 'hide_label': False, 'hide_property': False, 'is_custom': True, 'is_user_added': True, 'hide': False, 'display_name': 'decade'}, mode_allowed_input=True, mode_allowed_property=True, mode_allowed_output=True, parent_container_name='', initial_setup=True))
    node1_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='Agent', specific_library_name='Griptape Nodes Library', node_name='Agent_1', metadata={'position': {'x': 1405.5567786383533, 'y': 296.93529465485886}, 'tempId': 'placing-1765998525786-f45x3l', 'library_node_metadata': NodeMetadata(category='agents', description='Creates an AI agent with conversation memory and the ability to use tools', display_name='Agent', tags=None, icon=None, color=None, group='create', deprecation=None, is_node_group=None), 'library': 'Griptape Nodes Library', 'node_type': 'Agent', 'showaddparameter': False, 'size': {'width': 600, 'height': 1179}, 'category': 'agents'}, initial_setup=True)).node_name
    with GriptapeNodes.ContextManager().node(node1_name):
        GriptapeNodes.handle_request(AlterParameterDetailsRequest(parameter_name='additional_context', mode_allowed_property=False, initial_setup=True))
        GriptapeNodes.handle_request(AlterParameterDetailsRequest(parameter_name='tools', ui_options={'hide': True}, initial_setup=True))
        GriptapeNodes.handle_request(AddParameterToNodeRequest(parameter_name='rulesets_ParameterListUniqueParamID_6df8ae9c0e1a4a1881fc4f3986fbab35', default_value=[], tooltip='Rulesets to apply to the agent to control its behavior.', type='Ruleset', input_types=['Ruleset', 'list[Ruleset]'], output_type='Ruleset', ui_options={}, mode_allowed_input=True, mode_allowed_property=False, mode_allowed_output=False, is_user_defined=True, settable=True, parent_container_name='rulesets', initial_setup=True))
        GriptapeNodes.handle_request(AlterParameterDetailsRequest(parameter_name='output_schema', ui_options={'hide_property': True, 'hide': True}, initial_setup=True))
    node2_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='Ruleset', specific_library_name='Griptape Nodes Library', node_name='Ruleset_1', metadata={'position': {'x': 487.6351386036997, 'y': 1104.4096152628408}, 'tempId': 'placing-1765998085117-ktqra', 'library_node_metadata': NodeMetadata(category='agents/rules', description='Give an agent a set of rules and behaviors to follow', display_name='Ruleset', tags=None, icon=None, color=None, group='create', deprecation=None, is_node_group=None), 'library': 'Griptape Nodes Library', 'node_type': 'Ruleset', 'showaddparameter': False, 'size': {'width': 723, 'height': 933}, 'category': 'agents/rules'}, initial_setup=True)).node_name
    node3_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='MergeTexts', specific_library_name='Griptape Nodes Library', node_name='Merge Texts', metadata={'position': {'x': 487.6351386036997, 'y': 296.93529465485886}, 'tempId': 'placing-1766002459782-pzdym9', 'library_node_metadata': NodeMetadata(category='text', description='MergeTexts node', display_name='Merge Texts', tags=None, icon='merge', color=None, group='merge', deprecation=None, is_node_group=None), 'library': 'Griptape Nodes Library', 'node_type': 'MergeTexts', 'showaddparameter': False, 'size': {'width': 600, 'height': 500}, 'category': 'text', 'empty_merge_string_migrated': True}, resolution='resolved', initial_setup=True)).node_name
    node4_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='Note', specific_library_name='Griptape Nodes Library', node_name='Step 1', metadata={'position': {'x': -303.0843370080777, 'y': 66.8118912484619}, 'tempId': 'placing-1766003334530-pnkgh', 'library_node_metadata': NodeMetadata(category='misc', description='Create a note node to provide helpful context in your workflow', display_name='Note', tags=None, icon='notepad-text', color=None, group='create', deprecation=None, is_node_group=None), 'library': 'Griptape Nodes Library', 'node_type': 'Note', 'showaddparameter': False, 'size': {'width': 605, 'height': 175}, 'category': 'misc'}, resolution='resolved', initial_setup=True)).node_name
    node5_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='Note', specific_library_name='Griptape Nodes Library', node_name='Step 2', metadata={'position': {'x': 487.6351386036997, 'y': 66.8118912484619}, 'tempId': 'placing-1766003370124-fo9hq', 'library_node_metadata': NodeMetadata(category='misc', description='Create a note node to provide helpful context in your workflow', display_name='Note', tags=None, icon='notepad-text', color=None, group='create', deprecation=None, is_node_group=None), 'library': 'Griptape Nodes Library', 'node_type': 'Note', 'showaddparameter': False, 'size': {'width': 600, 'height': 170}, 'category': 'misc'}, resolution='resolved', initial_setup=True)).node_name
    node6_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='Note', specific_library_name='Griptape Nodes Library', node_name='Step 3', metadata={'position': {'x': 487.6351386036997, 'y': 890.6365870210909}, 'tempId': 'placing-1766003265679-b4mek', 'library_node_metadata': NodeMetadata(category='misc', description='Create a note node to provide helpful context in your workflow', display_name='Note', tags=None, icon='notepad-text', color=None, group='create', deprecation=None, is_node_group=None), 'library': 'Griptape Nodes Library', 'node_type': 'Note', 'showaddparameter': False, 'size': {'width': 710, 'height': 192}, 'category': 'misc'}, resolution='resolved', initial_setup=True)).node_name
    node7_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='Note', specific_library_name='Griptape Nodes Library', node_name='Step 4', metadata={'position': {'x': 1405.5567786383533, 'y': 66.8118912484619}, 'tempId': 'placing-1766003370124-fo9hq', 'library_node_metadata': NodeMetadata(category='misc', description='Create a note node to provide helpful context in your workflow', display_name='Note', tags=None, icon='notepad-text', color=None, group='create', deprecation=None, is_node_group=None), 'library': 'Griptape Nodes Library', 'node_type': 'Note', 'showaddparameter': False, 'size': {'width': 600, 'height': 163}, 'category': 'misc'}, resolution='resolved', initial_setup=True)).node_name
    node8_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='Note', specific_library_name='Griptape Nodes Library', node_name='Step 5', metadata={'position': {'x': 2216.14914549015, 'y': 66.8118912484619}, 'tempId': 'placing-1766003370124-fo9hq', 'library_node_metadata': NodeMetadata(category='misc', description='Create a note node to provide helpful context in your workflow', display_name='Note', tags=None, icon='notepad-text', color=None, group='create', deprecation=None, is_node_group=None), 'library': 'Griptape Nodes Library', 'node_type': 'Note', 'showaddparameter': False, 'size': {'width': 722, 'height': 153}, 'category': 'misc'}, resolution='resolved', initial_setup=True)).node_name
    node9_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='Note', specific_library_name='Griptape Nodes Library', node_name='Step 6', metadata={'position': {'x': 3230.0044593220005, 'y': 71.8118912484619}, 'tempId': 'placing-1766003370124-fo9hq', 'library_node_metadata': NodeMetadata(category='misc', description='Create a note node to provide helpful context in your workflow', display_name='Note', tags=None, icon='notepad-text', color=None, group='create', deprecation=None, is_node_group=None), 'library': 'Griptape Nodes Library', 'node_type': 'Note', 'showaddparameter': False, 'size': {'width': 722, 'height': 153}, 'category': 'misc'}, initial_setup=True)).node_name
    node10_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='QwenImageGeneration', specific_library_name='Griptape Nodes Library', node_name='Qwen Image Generation', metadata={'library_node_metadata': NodeMetadata(category='image', description='Generate images using Qwen models via Griptape model proxy', display_name='Qwen Image Generation', tags=None, icon='Sparkles', color=None, group='create', deprecation=None, is_node_group=None), 'library': 'Griptape Nodes Library', 'node_type': 'QwenImageGeneration', 'position': {'x': 2216.14914549015, 'y': 296.93529465485886}, 'size': {'width': 719, 'height': 1168}, 'showaddparameter': False, 'category': 'image'}, initial_setup=True)).node_name
    node11_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='Note', specific_library_name='Griptape Nodes Library', node_name='Workflow Description', metadata={'position': {'x': -303.0843370080777, 'y': -310.15782030394985}, 'tempId': 'placing-1766071929871-sjsa8nk', 'library_node_metadata': {'category': 'misc', 'description': 'Create a note node to provide helpful context in your workflow'}, 'library': 'Griptape Nodes Library', 'node_type': 'Note', 'showaddparameter': False, 'size': {'width': 603, 'height': 309}, 'category': 'misc'}, initial_setup=True)).node_name
    node12_name = GriptapeNodes.handle_request(CreateNodeRequest(node_type='EndFlow', specific_library_name='Griptape Nodes Library', node_name='End Flow', metadata={'library_node_metadata': NodeMetadata(category='workflows', description='Define the end of a workflow and return parameters from the flow', display_name='End Flow', tags=None, icon=None, color=None, group='create', deprecation=None, is_node_group=None), 'library': 'Griptape Nodes Library', 'node_type': 'EndFlow', 'showaddparameter': True, 'position': {'x': 3230.0044593220005, 'y': 296.93529465485886}, 'size': {'width': 945, 'height': 1244}}, initial_setup=True)).node_name
    with GriptapeNodes.ContextManager().node(node12_name):
        GriptapeNodes.handle_request(AddParameterToNodeRequest(parameter_name='image_url', default_value='', tooltip='New parameter', type='ImageUrlArtifact', input_types=['ImageUrlArtifact'], output_type='ImageUrlArtifact', ui_options={'is_full_width': True, 'pulse_on_run': True, 'is_custom': True, 'is_user_added': True}, mode_allowed_input=True, mode_allowed_property=True, mode_allowed_output=True, parent_container_name='', initial_setup=True))
    GriptapeNodes.handle_request(CreateConnectionRequest(source_node_name=node2_name, source_parameter_name='ruleset', target_node_name=node1_name, target_parameter_name='rulesets_ParameterListUniqueParamID_6df8ae9c0e1a4a1881fc4f3986fbab35', initial_setup=True))
    GriptapeNodes.handle_request(CreateConnectionRequest(source_node_name=node0_name, source_parameter_name='text', target_node_name=node3_name, target_parameter_name='input_2', initial_setup=True))
    GriptapeNodes.handle_request(CreateConnectionRequest(source_node_name=node0_name, source_parameter_name='text_1', target_node_name=node3_name, target_parameter_name='input_4', initial_setup=True))
    GriptapeNodes.handle_request(CreateConnectionRequest(source_node_name=node3_name, source_parameter_name='output', target_node_name=node1_name, target_parameter_name='additional_context', initial_setup=True))
    GriptapeNodes.handle_request(CreateConnectionRequest(source_node_name=node1_name, source_parameter_name='output', target_node_name=node10_name, target_parameter_name='prompt', initial_setup=True))
    GriptapeNodes.handle_request(CreateConnectionRequest(source_node_name=node10_name, source_parameter_name='image_url', target_node_name=node12_name, target_parameter_name='image_url', initial_setup=True))
    with GriptapeNodes.ContextManager().node(node0_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='text', node_name=node0_name, value=top_level_unique_values_dict['8ef484bc-a910-40ec-a55e-46f68482a672'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='text_1', node_name=node0_name, value=top_level_unique_values_dict['ba4efda3-109e-42f6-852e-b72f7dceb010'], initial_setup=True, is_output=False))
    with GriptapeNodes.ContextManager().node(node1_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='agent', node_name=node1_name, value=top_level_unique_values_dict['a7205e3a-d10b-4343-86b9-7f1c9b025370'], initial_setup=True, is_output=True))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='model', node_name=node1_name, value=top_level_unique_values_dict['f76f1e2f-d686-4e9a-835a-39205cc86e2d'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='prompt', node_name=node1_name, value=top_level_unique_values_dict['1d0b600f-32ee-4e4a-bf32-f7a6cc3c5c1f'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='additional_context', node_name=node1_name, value=top_level_unique_values_dict['b6961639-71ba-4805-b295-37051bc697f4'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='tools', node_name=node1_name, value=top_level_unique_values_dict['2e3340f7-514b-470e-90ed-d7ab33bb5a37'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='rulesets', node_name=node1_name, value=top_level_unique_values_dict['b503e0df-f92f-4d87-a32b-42ab63522178'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='rulesets_ParameterListUniqueParamID_6df8ae9c0e1a4a1881fc4f3986fbab35', node_name=node1_name, value=top_level_unique_values_dict['d3b774c4-8264-4ffc-9abb-fb25fe7dad83'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='output', node_name=node1_name, value=top_level_unique_values_dict['a4fe1814-6527-4049-bc7d-8acdbbb46b79'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='output', node_name=node1_name, value=top_level_unique_values_dict['81333882-790a-4fbc-8f23-fe49a3f3da69'], initial_setup=True, is_output=True))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='include_details', node_name=node1_name, value=top_level_unique_values_dict['1547bac3-4fd7-4d6a-9d64-3b41486a1770'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='logs', node_name=node1_name, value=top_level_unique_values_dict['ccc66f39-2bcb-408d-9faf-c8e94defb1fd'], initial_setup=True, is_output=True))
    with GriptapeNodes.ContextManager().node(node2_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='name', node_name=node2_name, value=top_level_unique_values_dict['e702e73f-0405-415e-bd36-7770d1736c02'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='rules', node_name=node2_name, value=top_level_unique_values_dict['e0311f55-6439-46ba-8ca0-00eac2c8f33c'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='ruleset', node_name=node2_name, value=top_level_unique_values_dict['d3b774c4-8264-4ffc-9abb-fb25fe7dad83'], initial_setup=True, is_output=True))
    with GriptapeNodes.ContextManager().node(node3_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='input_1', node_name=node3_name, value=top_level_unique_values_dict['f28322c8-a5e6-4232-be4c-e84f31fc03d4'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='input_2', node_name=node3_name, value=top_level_unique_values_dict['8ef484bc-a910-40ec-a55e-46f68482a672'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='input_3', node_name=node3_name, value=top_level_unique_values_dict['cb0cea0a-2d3f-4aa1-9853-501ff9bfe450'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='input_4', node_name=node3_name, value=top_level_unique_values_dict['ba4efda3-109e-42f6-852e-b72f7dceb010'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='merge_string', node_name=node3_name, value=top_level_unique_values_dict['d23d0b4f-f4c0-4cba-a099-850c62f8f158'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='whitespace', node_name=node3_name, value=top_level_unique_values_dict['1547bac3-4fd7-4d6a-9d64-3b41486a1770'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='output', node_name=node3_name, value=top_level_unique_values_dict['b6961639-71ba-4805-b295-37051bc697f4'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='output', node_name=node3_name, value=top_level_unique_values_dict['b6961639-71ba-4805-b295-37051bc697f4'], initial_setup=True, is_output=True))
    with GriptapeNodes.ContextManager().node(node4_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='note', node_name=node4_name, value=top_level_unique_values_dict['f8c5865a-eeb8-460e-87b5-80408a287a38'], initial_setup=True, is_output=False))
    with GriptapeNodes.ContextManager().node(node5_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='note', node_name=node5_name, value=top_level_unique_values_dict['6d47470d-e9d4-4d61-984e-ddd105d555cd'], initial_setup=True, is_output=False))
    with GriptapeNodes.ContextManager().node(node6_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='note', node_name=node6_name, value=top_level_unique_values_dict['a343ac05-4f5d-41fe-94d7-33a306b7eb0d'], initial_setup=True, is_output=False))
    with GriptapeNodes.ContextManager().node(node7_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='note', node_name=node7_name, value=top_level_unique_values_dict['40135bab-8eb7-4105-9fc5-d682eca19ef4'], initial_setup=True, is_output=False))
    with GriptapeNodes.ContextManager().node(node8_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='note', node_name=node8_name, value=top_level_unique_values_dict['db8799fa-2063-4e99-9562-a712d8ff46ab'], initial_setup=True, is_output=False))
    with GriptapeNodes.ContextManager().node(node9_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='note', node_name=node9_name, value=top_level_unique_values_dict['d89fa857-8653-488a-96b5-d87dcab08908'], initial_setup=True, is_output=False))
    with GriptapeNodes.ContextManager().node(node10_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='model', node_name=node10_name, value=top_level_unique_values_dict['400df2bb-997e-490b-8c33-fc5db425b73f'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='prompt', node_name=node10_name, value=top_level_unique_values_dict['81333882-790a-4fbc-8f23-fe49a3f3da69'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='size', node_name=node10_name, value=top_level_unique_values_dict['189cb527-1ad4-4467-ae4a-defe3514b143'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='prompt_extend', node_name=node10_name, value=top_level_unique_values_dict['1547bac3-4fd7-4d6a-9d64-3b41486a1770'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='watermark', node_name=node10_name, value=top_level_unique_values_dict['1547bac3-4fd7-4d6a-9d64-3b41486a1770'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='randomize_seed', node_name=node10_name, value=top_level_unique_values_dict['1547bac3-4fd7-4d6a-9d64-3b41486a1770'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='seed', node_name=node10_name, value=top_level_unique_values_dict['99b85ff0-451f-46bb-8e76-73311ac095d7'], initial_setup=True, is_output=False))
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='was_successful', node_name=node10_name, value=top_level_unique_values_dict['1547bac3-4fd7-4d6a-9d64-3b41486a1770'], initial_setup=True, is_output=False))
    with GriptapeNodes.ContextManager().node(node11_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='note', node_name=node11_name, value=top_level_unique_values_dict['043f4322-160e-4d09-9693-7086479a65a9'], initial_setup=True, is_output=False))
    with GriptapeNodes.ContextManager().node(node12_name):
        GriptapeNodes.handle_request(SetParameterValueRequest(parameter_name='was_successful', node_name=node12_name, value=top_level_unique_values_dict['1547bac3-4fd7-4d6a-9d64-3b41486a1770'], initial_setup=True, is_output=False))

def _ensure_workflow_context():
    context_manager = GriptapeNodes.ContextManager()
    if not context_manager.has_current_flow():
        top_level_flow_request = GetTopLevelFlowRequest()
        top_level_flow_result = GriptapeNodes.handle_request(top_level_flow_request)
        if isinstance(top_level_flow_result, GetTopLevelFlowResultSuccess) and top_level_flow_result.flow_name is not None:
            flow_manager = GriptapeNodes.FlowManager()
            flow_obj = flow_manager.get_flow_by_name(top_level_flow_result.flow_name)
            context_manager.push_flow(flow_obj)

def execute_workflow(input: dict, storage_backend: str='local', workflow_executor: WorkflowExecutor | None=None, pickle_control_flow_result: bool=False) -> dict | None:
    return asyncio.run(aexecute_workflow(input=input, storage_backend=storage_backend, workflow_executor=workflow_executor, pickle_control_flow_result=pickle_control_flow_result))

async def aexecute_workflow(input: dict, storage_backend: str='local', workflow_executor: WorkflowExecutor | None=None, pickle_control_flow_result: bool=False) -> dict | None:
    _ensure_workflow_context()
    storage_backend_enum = StorageBackend(storage_backend)
    workflow_executor = workflow_executor or LocalWorkflowExecutor(storage_backend=storage_backend_enum)
    async with workflow_executor as executor:
        await executor.arun(flow_input=input, pickle_control_flow_result=pickle_control_flow_result)
    return executor.output

if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    parser.add_argument('--storage-backend', choices=['local', 'gtc'], default='local', help="Storage backend to use: 'local' for local filesystem or 'gtc' for Griptape Cloud")
    parser.add_argument('--json-input', default=None, help='JSON string containing parameter values. Takes precedence over individual parameter arguments if provided.')
    parser.add_argument('--exec_out', default=None, help='Connection to the next node in the execution chain')
    parser.add_argument('--text', default=None, help='New parameter')
    parser.add_argument('--text_1', default=None, help='New parameter')
    args = parser.parse_args()
    flow_input = {}
    if args.json_input is not None:
        flow_input = json.loads(args.json_input)
    if args.json_input is None:
        if 'Start Flow' not in flow_input:
            flow_input['Start Flow'] = {}
        if args.exec_out is not None:
            flow_input['Start Flow']['exec_out'] = args.exec_out
        if args.text is not None:
            flow_input['Start Flow']['text'] = args.text
        if args.text_1 is not None:
            flow_input['Start Flow']['text_1'] = args.text_1
    workflow_output = execute_workflow(input=flow_input, storage_backend=args.storage_backend)
    print(workflow_output)
